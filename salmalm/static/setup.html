<!DOCTYPE html>
<html lang="ko"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SalmAlm â€” First Run</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,sans-serif;background:#0f1117;color:#e0e0e0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
.box{background:#1a1d27;padding:40px;border-radius:16px;border:1px solid #2a2d37;max-width:460px;width:100%;text-align:center}
h1{color:#a78bfa;font-size:26px;margin-bottom:8px}
.sub{color:#888;font-size:14px;margin-bottom:32px;line-height:1.6}
.choice{display:flex;gap:12px;margin-bottom:20px}
.choice button{flex:1;padding:16px;border-radius:12px;border:2px solid #333;background:#0f1117;color:#e0e0e0;font-size:15px;cursor:pointer;transition:all 0.2s}
.choice button:hover{border-color:#7c5cfc;background:#1e1b2e}
.choice button.selected{border-color:#7c5cfc;background:#1e1b2e}
.pw-area{display:none;margin:16px 0;text-align:left}
.pw-area label{font-size:13px;color:#aaa;display:block;margin-bottom:6px}
.pw-area input{width:100%;padding:10px 12px;border-radius:8px;border:1px solid #333;background:#0f1117;color:#e0e0e0;font-size:14px;margin-bottom:12px}
.pw-area input:focus{border-color:#7c5cfc;outline:none}
.go{width:100%;padding:14px;border-radius:8px;border:none;background:#4f46e5;color:#fff;font-size:16px;cursor:pointer;font-weight:500;display:none}
.go:hover{background:#4338ca}
.hint{font-size:12px;color:#666;margin-top:8px;line-height:1.5}
.err{color:#f87171;font-size:13px;margin-top:8px;display:none}
</style></head><body>
<div class="box">
<h1>ğŸ˜ˆ SalmAlm</h1>
<p class="sub" id="t-sub"></p>
<p style="font-size:15px;color:#ccc;margin-bottom:20px;font-weight:500" id="t-ask"></p>
<div class="choice">
  <button id="btn-yes" data-action="pickTrue"></button>
  <button id="btn-no" data-action="pickFalse"></button>
</div>
<div class="pw-area" id="pw-area">
  <label id="t-pw-label"></label>
  <input type="password" id="pw1">
  <label id="t-pw-confirm"></label>
  <input type="password" id="pw2" data-enter-action="go">
</div>
<button class="go" id="go-btn" data-action="go"></button>
<div class="err" id="err"></div>
<div class="hint" id="hint-yes" style="display:none"></div>
<div class="hint" id="hint-no" style="display:none"></div>
</div>
<script>
const L=localStorage.getItem('salmalm-lang')||'en';
const T=L==='ko'?{
  sub:'ì²˜ìŒ ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!<br>ì‹œì‘í•˜ê¸° ì „ì— í•˜ë‚˜ë§Œ ë¬¼ì–´ë³¼ê²Œìš”.',
  ask:'ğŸ”’ ë§ˆìŠ¤í„° ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
  yes:'ë„¤, ì„¤ì •í• ê²Œìš”',no:'ì•„ë‹ˆìš”, ë°”ë¡œ ì‹œì‘',
  pwl:'ë¹„ë°€ë²ˆí˜¸ (4ì ì´ìƒ)',pwc:'ë¹„ë°€ë²ˆí˜¸ í™•ì¸',
  pp1:'ë¹„ë°€ë²ˆí˜¸ ì…ë ¥',pp2:'ë‹¤ì‹œ ì…ë ¥',
  go:'ë‹¤ìŒ â†’',
  hy:'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•˜ë©´ ë¸Œë¼ìš°ì €ë¥¼ ì—´ ë•Œë§ˆë‹¤ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.<br>ë‚˜ì¤‘ì— ì„¤ì •ì—ì„œ ë³€ê²½í•˜ê±°ë‚˜ í•´ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
  hn:'ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ë°”ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.<br>ë‚˜ì¤‘ì— ì„¤ì •ì—ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
  e1:'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”',e2:'4ì ì´ìƒ ì…ë ¥í•˜ì„¸ìš”',e3:'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤',e4:'ì˜¤ë¥˜ ë°œìƒ',e5:'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜'
}:{
  sub:'Welcome!<br>One quick question before we start.',
  ask:'ğŸ”’ Would you like to set a master password?',
  yes:'Yes, set password',no:'No, start now',
  pwl:'Password (4+ characters)',pwc:'Confirm password',
  pp1:'Enter password',pp2:'Re-enter',
  go:'Next â†’',
  hy:'You will need to enter the password each time you open the browser.<br>You can change or remove it later in Settings.',
  hn:'You can start without a password.<br>You can add one later in Settings.',
  e1:'Please enter a password',e2:'Must be 4+ characters',e3:'Passwords do not match',e4:'Error occurred',e5:'Network error'
};
document.getElementById('t-sub').innerHTML=T.sub;
document.getElementById('t-ask').textContent=T.ask;
document.getElementById('btn-yes').textContent=T.yes;
document.getElementById('btn-no').textContent=T.no;
document.getElementById('t-pw-label').textContent=T.pwl;
document.getElementById('t-pw-confirm').textContent=T.pwc;
document.getElementById('pw1').placeholder=T.pp1;
document.getElementById('pw2').placeholder=T.pp2;
document.getElementById('go-btn').textContent=T.go;
document.getElementById('hint-yes').innerHTML=T.hy;
document.getElementById('hint-no').innerHTML=T.hn;
let usePw=null;
function pick(yes){
  usePw=yes;
  document.getElementById('btn-yes').className=yes?'selected':'';
  document.getElementById('btn-no').className=yes?'':'selected';
  document.getElementById('pw-area').style.display=yes?'block':'none';
  document.getElementById('go-btn').style.display='block';
  document.getElementById('hint-yes').style.display=yes?'block':'none';
  document.getElementById('hint-no').style.display=yes?'none':'block';
  document.getElementById('err').style.display='none';
  if(yes)document.getElementById('pw1').focus();
}
async function go(){
  const err=document.getElementById('err');
  err.style.display='none';
  if(usePw){
    const p1=document.getElementById('pw1').value,p2=document.getElementById('pw2').value;
    if(!p1){err.textContent=T.e1;err.style.display='block';return}
    if(p1.length<4){err.textContent=T.e2;err.style.display='block';return}
    if(p1!==p2){err.textContent=T.e3;err.style.display='block';return}
  }
  const body={use_password:usePw,password:usePw?document.getElementById('pw1').value:''};
  try{
    const r=await fetch('/api/setup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});
    const d=await r.json();
    if(d.ok)location.reload();
    else{err.textContent=d.error||T.e4;err.style.display='block'}
  }catch(e){err.textContent=T.e5;err.style.display='block'}
}
</script></body></html>