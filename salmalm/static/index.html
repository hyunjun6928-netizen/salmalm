<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SalmAlm â€” Personal AI Gateway</title>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#6366f1">
<link rel="icon" href="/icon-192.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/icon-192.svg">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Noto+Sans+KR:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#0b0d14;--bg2:#12141f;--bg3:#1a1d2b;--border:#252838;--text:#d4d4dc;--text2:#8889a0;
--accent:#7c5cfc;--accent2:#9b7dff;--accent-dim:rgba(124,92,252,0.12);--green:#34d399;--red:#f87171;
--user-bg:linear-gradient(135deg,#6d5cfc,#8b5cf6);--bot-bg:#161928;--yellow:#fbbf24;--blue:#60a5fa}
[data-theme="light"]{--bg:#f8f9fc;--bg2:#ffffff;--bg3:#f0f1f5;--border:#e2e4ea;--text:#1e293b;--text2:#64748b;
--accent:#6d5cfc;--accent2:#7c5cfc;--accent-dim:rgba(109,92,252,0.08);--green:#059669;--red:#dc2626;
--user-bg:linear-gradient(135deg,#6d5cfc,#8b5cf6);--bot-bg:#f7f7fb;--yellow:#d97706;--blue:#2563eb}
[data-color="ocean"]{--accent:#0ea5e9;--accent2:#38bdf8;--accent-dim:rgba(14,165,233,0.10)}
[data-color="forest"]{--accent:#22c55e;--accent2:#4ade80;--accent-dim:rgba(34,197,94,0.10)}
[data-color="rose"]{--accent:#f43f5e;--accent2:#fb7185;--accent-dim:rgba(244,63,94,0.10)}
[data-color="amber"]{--accent:#f59e0b;--accent2:#fbbf24;--accent-dim:rgba(245,158,11,0.10)}
[data-color="slate"]{--accent:#64748b;--accent2:#94a3b8;--accent-dim:rgba(100,116,139,0.10)}
[data-color="teal"]{--accent:#14b8a6;--accent2:#2dd4bf;--accent-dim:rgba(20,184,166,0.10)}
[data-color="indigo"]{--accent:#6366f1;--accent2:#818cf8;--accent-dim:rgba(99,102,241,0.10)}
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:'Inter','Noto Sans KR',system-ui,-apple-system,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Noto Color Emoji','Twemoji Mozilla';background:var(--bg);color:var(--text)}
body{display:grid;grid-template-rows:auto 1fr auto;grid-template-columns:260px 1fr;grid-template-areas:"side head" "side chat" "side input"}

/* SIDEBAR */
#sidebar{grid-area:side;background:var(--bg2);border-right:1px solid var(--border);display:flex;flex-direction:column;padding:0}
.side-header{padding:20px;border-bottom:1px solid var(--border)}
.side-header h1{font-size:20px;font-weight:600;display:flex;align-items:center;gap:8px}
.side-header h1 .icon{font-size:24px}
.side-header .tagline{font-size:11px;color:var(--text2);margin-top:4px;letter-spacing:0.5px;text-transform:uppercase}
.side-nav{flex:1;padding:12px;overflow-y:auto}
.nav-section{font-size:14px;color:var(--text2);text-transform:uppercase;letter-spacing:0.5px;padding:12px 8px 6px;font-weight:600}
.nav-item{padding:10px 12px;border-radius:8px;cursor:pointer;font-size:15px;color:var(--text2);display:flex;align-items:center;gap:10px;transition:all 0.15s}
.session-item{padding:7px 10px;font-size:12px;gap:4px}.session-item:hover .session-del{opacity:0.8}
.nav-item:hover{background:var(--accent-dim);color:var(--text)}
.nav-item.active{background:var(--accent-dim);color:var(--accent2);font-weight:500}
.nav-item .badge{margin-left:auto;background:var(--accent);color:#fff;font-size:10px;padding:2px 7px;border-radius:10px;font-weight:600}
.side-footer{padding:16px;border-top:1px solid var(--border);font-size:11px;color:var(--text2)}
.side-footer .status{display:flex;align-items:center;gap:6px;margin-bottom:6px}
.side-footer .dot{width:8px;height:8px;border-radius:50%;background:var(--green);display:inline-block}

/* HEADER */
#header{grid-area:head;padding:14px 24px;background:var(--bg2);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:16px}
#header .title{font-size:15px;font-weight:500}
#header .model-badge{font-size:11px;padding:4px 10px;border-radius:6px;background:var(--accent-dim);color:var(--accent2);font-weight:500}
#header .spacer{flex:1}
#header .cost{font-size:12px;color:var(--text2)}
#header .cost b{color:var(--green);font-weight:600}
#new-chat-btn{background:var(--accent-dim);color:var(--accent2);border:none;padding:6px 14px;border-radius:8px;font-size:12px;cursor:pointer;font-weight:500;transition:all 0.15s}
#new-chat-btn:hover{background:var(--accent);color:#fff}

/* CHAT */
#chat{grid-area:chat;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:8px;scroll-behavior:smooth}
#chat::-webkit-scrollbar{width:6px}
#chat::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
.msg-row{display:flex;gap:12px;max-width:90%;animation:fadeIn 0.2s ease}
.msg-row.user{align-self:flex-end;flex-direction:row-reverse}
.msg-row.assistant{align-self:flex-start}
.avatar{width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0}
.msg-row.user .avatar{background:var(--user-bg)}
.msg-row.assistant .avatar{background:var(--bg3);border:1px solid var(--border)}
.bubble{padding:10px 14px;border-radius:16px;font-size:14px;line-height:1.45;white-space:pre-wrap;word-break:break-word}
.msg-row.user .bubble{background:var(--user-bg);color:#fff;border-bottom-right-radius:4px}
.msg-row.assistant .bubble{background:var(--bot-bg);border:1px solid var(--border);border-bottom-left-radius:4px}
.bubble code{background:rgba(255,255,255,0.08);padding:2px 6px;border-radius:4px;font-size:13px;font-family:'SF Mono',monospace}
.bubble pre{background:rgba(0,0,0,0.3);padding:12px;border-radius:8px;overflow-x:auto;margin:8px 0;font-size:13px;border:1px solid var(--border)}
.tool-block{margin:4px 0;border-radius:6px;overflow:hidden;border:1px solid color-mix(in srgb,var(--accent) 20%,var(--border));font-size:12px}
.tool-header{padding:6px 10px;background:color-mix(in srgb,var(--accent) 8%,var(--bg2));cursor:pointer;font-size:12px;font-weight:500;list-style:none;display:flex;align-items:center;gap:6px;color:var(--text2)}
.tool-header::-webkit-details-marker{display:none}
.tool-header::before{content:'â–¶';font-size:9px;transition:transform 0.15s;color:var(--accent)}
details.tool-block[open]>.tool-header::before{transform:rotate(90deg)}
.tool-body{padding:8px 10px;margin:0;font-size:11px;overflow-x:auto;background:var(--bg);border-top:1px solid color-mix(in srgb,var(--accent) 15%,var(--border));max-height:200px;overflow-y:auto;color:var(--text2);line-height:1.4}
.bubble pre code{background:none;padding:0;font-size:13px}
/* Syntax highlight keywords */
.bubble pre .kw{color:#c792ea}.bubble pre .str{color:#c3e88d}.bubble pre .num{color:#f78c6c}.bubble pre .cmt{color:#546e7a;font-style:italic}
/* Drag highlight */
.input-area.drag-over{border:2px dashed var(--accent);background:var(--accent-dim);transition:all 0.2s}
/* Scroll to bottom button */
#scroll-bottom{position:fixed;bottom:100px;right:24px;width:40px;height:40px;border-radius:50%;background:var(--bg3);border:1px solid var(--border);color:var(--text2);font-size:18px;cursor:pointer;display:none;align-items:center;justify-content:center;z-index:50;transition:opacity 0.2s}
#scroll-bottom:hover{background:var(--accent-dim);color:var(--accent2)}
/* Message actions */
.msg-actions{opacity:0;transition:opacity 0.15s;display:inline-flex;gap:4px;margin-left:8px}
.msg-row:hover .msg-actions{opacity:1}
.msg-actions span{cursor:pointer;font-size:12px;padding:2px 4px;border-radius:4px}
.msg-actions span:hover{background:var(--accent-dim)}
.bubble pre code{background:none;padding:0}
.meta{font-size:11px;color:var(--text2);margin-top:4px;display:flex;gap:8px;align-items:center}
.msg-row.user .meta{justify-content:flex-end}
.typing-indicator{display:flex;gap:4px;padding:8px 0}
.typing-indicator span{width:7px;height:7px;border-radius:50%;background:var(--text2);animation:bounce 1.4s infinite ease-in-out}
.typing-indicator span:nth-child(2){animation-delay:0.2s}
.typing-indicator span:nth-child(3){animation-delay:0.4s}
@keyframes bounce{0%,80%,100%{transform:scale(0.6)}40%{transform:scale(1)}}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* INPUT */
#input-area{grid-area:input;padding:16px 24px;background:var(--bg2);border-top:1px solid var(--border)}
.input-box{display:flex;gap:8px;align-items:flex-end;background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:8px 12px;transition:border-color 0.2s}
.input-box:focus-within{border-color:var(--accent)}
#input{flex:1;padding:6px 0;border:none;background:transparent;color:var(--text);font-size:14px;font-family:inherit;outline:none;resize:none;max-height:150px;line-height:1.5}
#send-btn{width:36px;height:36px;border-radius:10px;border:none;background:var(--accent);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.15s;flex-shrink:0}
#send-btn:hover{background:var(--accent2);transform:scale(1.05)}
#send-btn:disabled{opacity:0.3;cursor:not-allowed;transform:none}
#send-btn svg{width:18px;height:18px}
.input-hint{font-size:11px;color:var(--text2);margin-top:6px;text-align:center}

/* SETTINGS PANEL */
#settings{display:none;grid-area:chat;overflow-y:auto;padding:24px}
.settings-card{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px;margin-bottom:16px}
.settings-card h3{font-size:14px;font-weight:600;margin-bottom:12px;color:var(--accent2)}
.settings-card label{font-size:12px;color:var(--text2);display:block;margin-bottom:4px}
.settings-card input,.settings-card select{width:100%;padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px;margin-bottom:12px}
.settings-card .btn{padding:8px 16px;border-radius:8px;border:none;background:var(--accent);color:#fff;cursor:pointer;font-size:13px}
.settings-tab.active{color:var(--accent2)!important;border-bottom-color:var(--accent)!important}
.feat-cat{margin-bottom:12px;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:var(--bg2)}
.feat-cat-header{display:flex;align-items:center;gap:8px;padding:14px 16px;cursor:pointer;font-weight:600;font-size:14px;user-select:none}
.feat-cat-header:hover{background:var(--bg3)}
.feat-cat-header .arrow{transition:transform .2s;font-size:10px}
.feat-cat.open .arrow{transform:rotate(90deg)}
.feat-cat-body{display:none;padding:8px 16px 16px}
.feat-cat.open .feat-cat-body{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:10px}
.feat-card{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:12px 14px;font-size:13px}
.feat-card .feat-name{font-weight:600;margin-bottom:4px}
.feat-card .feat-desc{color:var(--text2);font-size:12px;margin-bottom:6px}
.feat-card .feat-cmd{display:inline-block;background:var(--accent-dim,rgba(59,130,246,0.15));color:var(--accent2);padding:2px 8px;border-radius:6px;font-size:11px;font-family:monospace;cursor:pointer;border:none}
.feat-card .feat-cmd:hover{background:var(--accent);color:#fff}
@media(max-width:600px){.feat-cat.open .feat-cat-body{grid-template-columns:1fr}}

/* TOOL CALL DISPLAY */
.tool-call{background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:8px 12px;margin:6px 0;font-size:12px;font-family:'SF Mono',monospace}
.tool-call .tool-name{color:var(--accent2);font-weight:600}
.tool-call .tool-result{color:var(--text2);margin-top:4px;max-height:120px;overflow-y:auto}

/* COPY BUTTON */
.copy-btn{position:absolute;top:6px;right:6px;background:var(--bg3);border:1px solid var(--border);color:var(--text2);padding:3px 8px;border-radius:4px;font-size:10px;cursor:pointer;opacity:0;transition:opacity 0.15s}
.bubble:hover .copy-btn{opacity:1}
.bubble{position:relative}
.bubble pre{position:relative}

/* STATS BAR */
#stats-bar{display:flex;gap:16px;padding:6px 12px;background:var(--bg);border-radius:8px;margin-top:8px;font-size:11px;color:var(--text2)}
#stats-bar .stat{display:flex;align-items:center;gap:4px}
#stats-bar .stat-val{color:var(--accent2);font-weight:600}

/* THEME TOGGLE */
#theme-toggle{background:none;border:1px solid var(--border);color:var(--text2);padding:4px 10px;border-radius:6px;cursor:pointer;font-size:14px;transition:all 0.15s}
#theme-toggle:hover{border-color:var(--accent);color:var(--text)}

/* MOBILE MENU BUTTON */
#mobile-menu-btn{display:none;background:none;border:none;color:var(--text);font-size:20px;cursor:pointer;padding:4px}

/* SEARCH MODAL */
#search-modal{display:none;position:fixed;inset:0;z-index:2000;background:rgba(0,0,0,0.6);align-items:flex-start;justify-content:center;padding-top:15vh}
#search-modal.open{display:flex}
#search-box{background:var(--bg2);border:1px solid var(--border);border-radius:16px;width:560px;max-width:90vw;max-height:60vh;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,0.4)}
#search-input{padding:16px 20px;border:none;background:transparent;color:var(--text);font-size:15px;outline:none;border-bottom:1px solid var(--border)}
#search-input::placeholder{color:var(--text2)}
#search-results{overflow-y:auto;padding:8px;flex:1}
.search-item{padding:10px 14px;border-radius:8px;cursor:pointer;font-size:13px;line-height:1.5;transition:background 0.1s}
.search-item:hover{background:var(--accent-dim)}
.search-item .sr-session{font-size:11px;color:var(--text2)}
.search-item .sr-snippet{color:var(--text)}
.search-item mark{background:var(--accent-dim);color:var(--accent2);padding:1px 2px;border-radius:2px}
#search-hint{padding:12px 16px;font-size:11px;color:var(--text2);text-align:center;border-top:1px solid var(--border)}

/* MODEL BADGE ON BUBBLES */
.model-tag{display:inline-block;font-size:10px;padding:2px 6px;border-radius:4px;background:var(--accent-dim);color:var(--accent2);margin-right:4px;font-weight:500}
/* TTS BUTTON */
.tts-btn{background:none;border:none;cursor:pointer;font-size:14px;opacity:0.5;transition:opacity 0.15s;padding:2px 4px}
.tts-btn:hover{opacity:1}

/* MESSAGE EDIT/DELETE ACTIONS */
.msg-edit-actions{opacity:0;transition:opacity 0.15s;display:inline-flex;gap:2px;margin-left:4px}
.msg-row.user:hover .msg-edit-actions{opacity:1}
.msg-edit-actions button{background:none;border:none;cursor:pointer;font-size:13px;padding:2px 4px;border-radius:4px;opacity:0.6;transition:opacity 0.15s}
.msg-edit-actions button:hover{opacity:1;background:var(--accent-dim)}
.edit-textarea{width:100%;min-height:60px;padding:10px 12px;border-radius:10px;border:1px solid var(--accent);background:var(--bg);color:var(--text);font-size:14px;font-family:inherit;resize:vertical;outline:none;line-height:1.5}
.edit-textarea:focus{border-color:var(--accent2);box-shadow:0 0 0 2px var(--accent-dim)}
.edit-bar{display:flex;gap:6px;margin-top:6px;font-size:12px}
.edit-bar button{padding:4px 12px;border-radius:6px;border:none;cursor:pointer;font-size:12px}
.edit-bar .save-btn{background:var(--accent);color:#fff}
.edit-bar .cancel-btn{background:var(--bg3);color:var(--text2)}
/* EXPORT DROPDOWN */
.export-dropdown{position:relative;display:inline-block}
.export-menu{display:none;position:absolute;top:100%;right:0;background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:4px;min-width:150px;z-index:100;box-shadow:0 8px 24px rgba(0,0,0,0.3);margin-top:4px}
.export-menu.open{display:block}
.export-menu button{display:block;width:100%;text-align:left;padding:8px 12px;border:none;background:none;color:var(--text);font-size:13px;cursor:pointer;border-radius:6px}
.export-menu button:hover{background:var(--accent-dim);color:var(--accent2)}
/* COMMAND PALETTE */
#cmd-palette{position:fixed;top:15vh;left:50%;transform:translateX(-50%);background:var(--bg2);border:1px solid var(--border);border-radius:16px;width:520px;max-width:92vw;max-height:60vh;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,0.5);z-index:10001;display:none}
#cmd-palette.open{display:flex}
#cmd-input{padding:14px 18px;border:none;background:transparent;color:var(--text);font-size:15px;outline:none;border-bottom:1px solid var(--border)}
#cmd-input::placeholder{color:var(--text2)}
#cmd-results{overflow-y:auto;padding:6px;flex:1;max-height:50vh}
.cmd-item{padding:10px 14px;border-radius:8px;cursor:pointer;font-size:13px;display:flex;align-items:center;gap:10px;transition:background 0.1s}
.cmd-item:hover,.cmd-item.selected{background:var(--accent-dim);color:var(--accent2)}
.cmd-item .cmd-icon{font-size:16px;width:24px;text-align:center}
.cmd-item .cmd-label{flex:1}
.cmd-item .cmd-shortcut{font-size:11px;color:var(--text2)}
#cmd-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:10000}
#cmd-overlay.open{display:block}
/* PWA INSTALL BANNER */
#pwa-install{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:var(--bg2);border:1px solid var(--accent);border-radius:12px;padding:12px 20px;z-index:500;box-shadow:0 8px 24px rgba(0,0,0,0.3);font-size:13px;align-items:center;gap:12px;display:none}
#pwa-install.show{display:flex}
#pwa-install button{padding:6px 14px;border-radius:8px;border:none;cursor:pointer;font-size:12px}
#pwa-install .install-btn{background:var(--accent);color:#fff}
#pwa-install .dismiss-btn{background:var(--bg3);color:var(--text2)}
/* MOBILE */
@media(max-width:768px){
  body{grid-template-columns:1fr;grid-template-areas:"head" "chat" "input"}
  #sidebar{display:none;position:fixed;top:0;left:0;width:280px;height:100%;z-index:1000;box-shadow:4px 0 24px rgba(0,0,0,0.4)}
  #sidebar.open{display:flex}
  #mobile-menu-btn{display:block}
  .msg-row{max-width:95%}
  #chat{padding:12px}
  #input-area{padding:10px 12px}
  .input-hint{display:none}
  #header{padding:10px 12px}
  .side-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:999}
  .side-overlay.open{display:block}
  .nav-item{min-height:44px;padding:12px}
  .session-item{min-height:40px}
  #send-btn{width:44px;height:44px}
  #input{font-size:16px}
  #cmd-palette{width:100%;max-width:100%;top:0;left:0;transform:none;border-radius:0;max-height:100vh;height:100vh}
  #search-box{width:100%;max-width:100%;border-radius:0;max-height:100vh}
  #search-modal.open{padding-top:0}
  .msg-edit-actions{opacity:1}
  .bubble pre{max-width:calc(100vw - 80px);overflow-x:auto;-webkit-overflow-scrolling:touch}
  #filter-modal{width:100%;max-width:100%;left:0;transform:none;border-radius:0;top:0;height:100vh;max-height:100vh}
  input,textarea,select{font-size:16px!important}
}
/* i18n: hide Korean by default, toggle via JS */
.eng-kr{display:none}
</style></head><body>

<div id="sidebar">
  <div class="side-header">
    <h1><span class="icon">ğŸ˜ˆ</span> SalmAlm</h1>
    <div class="tagline">Personal AI Gateway</div>
  </div>
  <div class="side-nav">
    <div style="display:flex;align-items:center;justify-content:space-between;padding:8px 16px 4px">
      <div class="nav-section" style="margin:0;padding:0;cursor:pointer" data-action="showChat" data-i18n="sec-chats">ğŸ’¬ Chats</div>
      <button data-action="newSession" title="New Chat" style="background:var(--accent);color:#fff;border:none;width:28px;height:28px;border-radius:8px;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center">+</button>
    </div>
    <div id="session-list" style="max-height:240px;overflow-y:auto;padding:0 8px 4px"></div>
    <div class="nav-section" style="border-top:1px solid var(--border);margin-top:4px;padding-top:8px" data-i18n="sec-channels">Channels</div>
    <div class="nav-item" data-action="showSettings" id="tg-status" style="font-size:12px">ğŸ“¡ Telegram <span class="badge" style="font-size:10px">â€”</span></div>
    <div class="nav-item" data-action="showSettings" id="dc-status" style="font-size:12px">ğŸ® Discord <span class="badge" style="font-size:10px">â€”</span></div>
    <div class="nav-section" data-i18n="sec-manage">Manage</div>
    <div class="nav-item" data-action="showSessions" data-i18n="nav-sessions">ğŸ“‹ Sessions</div>
    <div class="nav-section" data-action="toggleTools" style="cursor:pointer" id="tools-header">ğŸ› ï¸ Tools â–¾</div>
    <div id="tools-list" style="display:none">
    <input id="tools-search" type="text" placeholder="Search tools..." style="width:calc(100% - 16px);margin:4px 8px;padding:6px 10px;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:12px;outline:none">
    <div id="tools-items" style="max-height:320px;overflow-y:auto"></div>
    </div>
    <div class="nav-section" data-i18n="sec-admin">Admin</div>
    <div class="nav-item" data-action="showCron" data-i18n="nav-cron">â° Cron Jobs</div>
    <div class="nav-item" data-action="showMemory" data-i18n="nav-memory">ğŸ§  Memory</div>
    <div class="nav-item" data-action="showSettings" data-i18n="nav-settings">âš™ï¸ Settings</div>
    <div class="nav-item" data-action="showDashboard" data-i18n="nav-dashboard">ğŸ“ˆ Dashboard</div>
    <div class="nav-item" data-action="showDocs" data-i18n="nav-docs">ğŸ“– Docs</div>
  </div>
  <div class="side-footer">
    <div class="status"><span class="dot"></span> Running</div>
    <div>{{VERSION}} Â· AES-256-GCM</div>
  </div>
</div>

<div class="side-overlay" id="side-overlay" data-action="toggleSidebar"></div>

<div id="header">
  <button id="mobile-menu-btn" data-action="toggleSidebar">â˜°</button>
  <div class="title">ğŸ’¬ Web Chat</div>
  <div class="model-badge" id="model-badge">auto routing</div>
  <div class="spacer"></div>
  <div class="cost">Cost: <b id="cost-display">$0.0000</b></div>
  <button id="theme-toggle" data-action="toggleTheme" title="Toggle theme">ğŸŒ™</button>
  <div class="export-dropdown"><button id="export-btn" data-action="toggleExportMenu" title="Export chat" style="background:var(--accent-dim);color:var(--accent2);border:none;padding:6px 14px;border-radius:8px;font-size:12px;cursor:pointer"data-i18n="btn-export">ğŸ“¥ Export</button><div id="export-menu" class="export-menu"><button data-action="exportMd">ğŸ“ Markdown</button><button data-action="exportJson">ğŸ“‹ JSON</button><button data-action="exportServerMd">ğŸ“¥ Download MD</button><button data-action="exportServerJson">ğŸ“¥ Download JSON</button></div></div>
  <button id="new-chat-btn" data-action="newSession" title="New Chat">âœ¨ New</button>
</div>

<div id="update-banner" style="display:none;background:linear-gradient(135deg,#1e3a5f,#2d1b69);border:1px solid #3b82f6;border-radius:12px;padding:12px 16px;margin:8px 16px;display:none;align-items:center;justify-content:space-between;font-size:13px">
  <span>â¬†ï¸ <b>Update Available</b> â€” <span id="banner-ver"></span></span>
  <button data-action="doUpdate" style="background:#3b82f6;color:#fff;border:none;border-radius:8px;padding:6px 16px;cursor:pointer;font-size:12px">Update Now</button>
</div>
<div id="chat"></div>

<div id="settings">
  <div style="display:flex;gap:0;border-bottom:2px solid var(--border);margin-bottom:16px">
    <button class="settings-tab active" data-settings-tab="general" style="padding:10px 20px;border:none;background:none;color:var(--text);cursor:pointer;font-size:14px;font-weight:600;border-bottom:2px solid transparent;margin-bottom:-2px" data-i18n="tab-general">âš™ï¸ General</button>
    <button class="settings-tab" data-settings-tab="features" style="padding:10px 20px;border:none;background:none;color:var(--text2);cursor:pointer;font-size:14px;font-weight:600;border-bottom:2px solid transparent;margin-bottom:-2px" data-i18n="tab-features">ğŸ“– Features</button>
    <button class="settings-tab" data-settings-tab="model-router" style="padding:10px 20px;border:none;background:none;color:var(--text2);cursor:pointer;font-size:14px;font-weight:600;border-bottom:2px solid transparent;margin-bottom:-2px">ğŸ¤– Model</button>
    <button class="settings-tab" data-settings-tab="debug" style="padding:10px 20px;border:none;background:none;color:var(--text2);cursor:pointer;font-size:14px;font-weight:600;border-bottom:2px solid transparent;margin-bottom:-2px" data-i18n="tab-debug">ğŸ”¬ Debug</button>
    <button class="settings-tab" data-settings-tab="logs" style="padding:10px 20px;border:none;background:none;color:var(--text2);cursor:pointer;font-size:14px;font-weight:600;border-bottom:2px solid transparent;margin-bottom:-2px" data-i18n="tab-logs">ğŸ“‹ Logs</button>
  </div>
  <div id="settings-general">
  <div class="settings-card">
    <h3 data-i18n="h-lang">ğŸŒ Language</h3>
    <select id="s-lang" data-action="setLang" style="width:200px">
      <option value="en">English</option>
      <option value="ko">í•œêµ­ì–´</option>
    </select>
  </div>
  <div class="settings-card">
    <h3>ğŸ¨ <span data-i18n="h-color">Accent Color</span></h3>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <div class="color-dot" data-action="setColorDot" data-color="" style="width:28px;height:28px;border-radius:50%;background:#7c5cfc;cursor:pointer" title="Purple (default)"></div>
      <div class="color-dot" data-action="setColorDot" data-color="ocean" style="width:28px;height:28px;border-radius:50%;background:#0ea5e9;cursor:pointer" title="Ocean"></div>
      <div class="color-dot" data-action="setColorDot" data-color="teal" style="width:28px;height:28px;border-radius:50%;background:#14b8a6;cursor:pointer" title="Teal"></div>
      <div class="color-dot" data-action="setColorDot" data-color="forest" style="width:28px;height:28px;border-radius:50%;background:#22c55e;cursor:pointer" title="Forest"></div>
      <div class="color-dot" data-action="setColorDot" data-color="amber" style="width:28px;height:28px;border-radius:50%;background:#f59e0b;cursor:pointer" title="Amber"></div>
      <div class="color-dot" data-action="setColorDot" data-color="rose" style="width:28px;height:28px;border-radius:50%;background:#f43f5e;cursor:pointer" title="Rose"></div>
      <div class="color-dot" data-action="setColorDot" data-color="slate" style="width:28px;height:28px;border-radius:50%;background:#64748b;cursor:pointer" title="Slate"></div>
      <div class="color-dot" data-action="setColorDot" data-color="indigo" style="width:28px;height:28px;border-radius:50%;background:#6366f1;cursor:pointer" title="Indigo"></div>
    </div>
  </div>
  <!-- Model & API Key settings moved to Model tab -->
  <div class="settings-card" id="google-oauth-card">
    <h3 data-i18n="h-google-oauth">ğŸ”— Google Integration (Calendar & Gmail)</h3>
    <p style="font-size:12px;color:var(--text2);margin-bottom:12px;line-height:1.6">
      <span data-i18n="google-oauth-desc">OAuth2 integration is required for Google Calendar and Gmail features.</span><br>
      <a href="https://console.cloud.google.com/apis/credentials" target="_blank" rel="noopener" style="color:var(--accent2)">Google Cloud Console</a> â€” <span data-i18n="google-oauth-console">Create an OAuth 2.0 Client ID at Google Cloud Console.</span>
    </p>
    <label data-i18n="lbl-google-client-id">Google Client ID</label>
    <div style="display:flex;gap:6px"><input id="sk-google-client-id" type="password" placeholder="xxxx.apps.googleusercontent.com"><button class="btn" data-action="save-google-client-id">Save</button></div>
    <label data-i18n="lbl-google-client-secret">Google Client Secret</label>
    <div style="display:flex;gap:6px"><input id="sk-google-client-secret" type="password" placeholder="GOCSPX-..."><button class="btn" data-action="save-google-client-secret">Save</button></div>
    <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
      <button class="btn" data-action="googleConnect" id="google-connect-btn" data-i18n="btn-google-connect">ğŸ”— Connect Google Account</button>
      <button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="googleDisconnect" data-i18n="btn-google-disconnect">Disconnect</button>
      <span id="google-status" style="font-size:12px;color:var(--text2)"></span>
    </div>
    <div id="google-result" style="margin-top:8px;font-size:12px"></div>
    <details style="margin-top:12px">
      <summary style="font-size:12px;color:var(--text2);cursor:pointer">ğŸ“‹ Setup Guide (click to expand)</summary>
      <ol class="google-guide-en" style="font-size:12px;color:var(--text2);margin-top:8px;padding-left:20px;line-height:2.2">
        <li>Go to <a href="https://console.cloud.google.com" target="_blank" rel="noopener" style="color:var(--accent2)">console.cloud.google.com</a> â†’ Create or select a project</li>
        <li>â˜° Menu â†’ <b>APIs & Services</b> â†’ <b>Enabled APIs</b> â†’ <b>+ ENABLE APIS AND SERVICES</b></li>
        <li>Search and enable <b>Google Calendar API</b> and <b>Gmail API</b></li>
        <li>â˜° Menu â†’ <b>APIs & Services</b> â†’ <b>OAuth consent screen</b> â†’ <b>Audience</b> tab â†’ <b>Add users</b> â†’ Enter your Gmail</li>
        <li>Left menu â†’ <b>Credentials</b> â†’ <b>+ CREATE CREDENTIALS</b> â†’ <b>OAuth client ID</b></li>
        <li>Application type: <b>Web application</b></li>
        <li>Authorized redirect URIs â†’ <b>+ ADD URI</b> â†’ <code class="google-redirect-uri" style="background:var(--bg);padding:2px 6px;border-radius:4px"></code></li>
        <li>Click <b>CREATE</b> â†’ Copy Client ID and Client Secret</li>
        <li>Paste them in the fields above â†’ <b>Save</b></li>
        <li>Click ğŸ”— <b>Connect Google Account</b></li>
      </ol>
      <ol class="google-guide-kr" style="display:none;font-size:12px;color:var(--text2);margin-top:8px;padding-left:20px;line-height:2.2">
        <li><a href="https://console.cloud.google.com" target="_blank" rel="noopener" style="color:var(--accent2)">console.cloud.google.com</a> ì ‘ì† â†’ í”„ë¡œì íŠ¸ ìƒì„± (ë˜ëŠ” ê¸°ì¡´ í”„ë¡œì íŠ¸ ì„ íƒ)</li>
        <li>ì¢Œì¸¡ â‰¡ ë©”ë‰´ â†’ <b>APIs & Services</b> â†’ <b>Enabled APIs</b> â†’ <b>+ ENABLE APIS AND SERVICES</b></li>
        <li><b>Google Calendar API</b>ì™€ <b>Gmail API</b> ê²€ìƒ‰í•˜ì—¬ ê°ê° <b>Enable</b></li>
        <li>ì¢Œì¸¡ â‰¡ ë©”ë‰´ â†’ <b>APIs & Services</b> â†’ <b>OAuth consent screen</b> â†’ <b>Audience</b> íƒ­ â†’ <b>Add users</b> â†’ ë³¸ì¸ Gmail ì…ë ¥</li>
        <li>ì¢Œì¸¡ ë©”ë‰´ â†’ <b>Credentials</b> â†’ <b>+ CREATE CREDENTIALS</b> â†’ <b>OAuth client ID</b></li>
        <li>Application type: <b>Web application</b></li>
        <li>Authorized redirect URIs â†’ <b>+ ADD URI</b> â†’ <code class="google-redirect-uri" style="background:var(--bg);padding:2px 6px;border-radius:4px"></code></li>
        <li><b>CREATE</b> í´ë¦­ â†’ Client IDì™€ Client Secret ë³µì‚¬</li>
        <li>ìœ„ ì…ë ¥ë€ì— ë¶™ì—¬ë„£ê¸° í›„ <b>Save</b></li>
        <li>ğŸ”— <b>Google ê³„ì • ì—°ê²°</b> í´ë¦­</li>
      </ol>
    </details>
  </div>
  <div class="settings-card" id="telegram-card">
    <h3>ğŸ¤– Telegram Bot</h3>
    <p style="font-size:12px;color:var(--text2);margin-bottom:12px;line-height:1.6">
      <span data-i18n="tg-desc">Connect a Telegram bot to chat with your AI from Telegram.</span>
    </p>
    <label data-i18n="lbl-tg-token">Bot Token</label>
    <div style="display:flex;gap:6px"><input id="sk-telegram-token" type="password" placeholder="123456:ABC-DEF..."><button class="btn" data-action="save-telegram-token">Save</button></div>
    <label data-i18n="lbl-tg-owner">Owner Chat ID</label>
    <div style="display:flex;gap:6px"><input id="sk-telegram-owner" type="text" placeholder="123456789"><button class="btn" data-action="save-telegram-owner">Save</button></div>
    <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
      <span id="tg-conn-status" style="font-size:12px;color:var(--text2)">âšª <span data-i18n="tg-disconnected">Not connected</span></span>
    </div>
    <details style="margin-top:12px">
      <summary style="font-size:12px;color:var(--text2);cursor:pointer" data-i18n="tg-guide-title">ğŸ“‹ Setup Guide (click to expand)</summary>
      <div class="tg-guide-en" style="font-size:12px;color:var(--text2);margin-top:10px;line-height:2">
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border)">
          <b>Step 1: Create a Telegram Bot</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Open the <a href="https://telegram.org/apps" target="_blank" rel="noopener" style="color:var(--accent2)">Telegram app</a> on your phone or desktop</li>
            <li>In the search bar, type <code>@BotFather</code> and open the official bot (blue checkmark âœ“)</li>
            <li>Send <code>/newbot</code> to BotFather</li>
            <li>BotFather will ask: <b>"What name for your bot?"</b> â†’ Type any name (e.g. <code>My AI Assistant</code>)</li>
            <li>Next: <b>"Choose a username"</b> â†’ Must end in <code>bot</code> (e.g. <code>myai_salmalm_bot</code>)</li>
            <li>BotFather replies with your <b>Bot Token</b> â€” looks like: <code>7123456789:AAH...</code></li>
            <li><b>Copy the entire token</b> and paste it in the "Bot Token" field above â†’ click <b>Save</b></li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>Step 2: Find your Chat ID</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Open your new bot in Telegram (search its username) and send any message (e.g. <code>hello</code>)</li>
            <li>Open this URL in your browser (replace <code>&lt;TOKEN&gt;</code> with your actual bot token):<br>
              <code style="background:var(--bg2);padding:4px 8px;border-radius:4px;display:inline-block;margin:4px 0">https://api.telegram.org/bot<b>&lt;TOKEN&gt;</b>/getUpdates</code></li>
            <li>Look for <code>"chat":{"id":<b>123456789</b></code> in the response â€” that number is your <b>Chat ID</b></li>
            <li>Paste it in the "Owner Chat ID" field above â†’ click <b>Save</b></li>
          </ol>
          <div style="color:var(--accent);margin-top:4px">ğŸ’¡ <b>Tip:</b> You can also use <a href="https://t.me/userinfobot" target="_blank" rel="noopener" style="color:var(--accent2)">@userinfobot</a> on Telegram â€” just send it any message and it replies with your Chat ID.</div>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>Step 3: Activate</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Restart SalmAlm: close the terminal and run <code>salmalm</code> again</li>
            <li>Send a message to your bot in Telegram â€” you should get an AI response! ğŸ‰</li>
          </ol>
          <div style="color:var(--accent);margin-top:4px">ğŸ’¡ <b>Note:</b> Only the Owner Chat ID can talk to the bot. Other users will be ignored for security.</div>
        </div>
      </div>
      <div class="tg-guide-kr" style="display:none;font-size:12px;color:var(--text2);margin-top:10px;line-height:2">
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border)">
          <b>1ë‹¨ê³„: í…”ë ˆê·¸ë¨ ë´‡ ìƒì„±</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li><a href="https://telegram.org/apps" target="_blank" rel="noopener" style="color:var(--accent2)">í…”ë ˆê·¸ë¨ ì•±</a>ì„ ì—´ê³  ê²€ìƒ‰ì°½ì— <code>@BotFather</code> ì…ë ¥ (íŒŒë€ ì²´í¬ë§ˆí¬ âœ“ í™•ì¸)</li>
            <li>BotFatherì—ê²Œ <code>/newbot</code> ì „ì†¡</li>
            <li><b>"ë´‡ ì´ë¦„ì„ ì •í•˜ì„¸ìš”"</b> â†’ ì›í•˜ëŠ” ì´ë¦„ ì…ë ¥ (ì˜ˆ: <code>ë‚´ AI ë¹„ì„œ</code>)</li>
            <li><b>"ìœ ì €ë„¤ì„ì„ ì •í•˜ì„¸ìš”"</b> â†’ ë°˜ë“œì‹œ <code>bot</code>ìœ¼ë¡œ ëë‚˜ì•¼ í•¨ (ì˜ˆ: <code>myai_salmalm_bot</code>)</li>
            <li>BotFatherê°€ <b>Bot Token</b>ì„ ì•Œë ¤ì¤Œ â€” <code>7123456789:AAH...</code> í˜•íƒœ</li>
            <li><b>í† í° ì „ì²´ë¥¼ ë³µì‚¬</b>í•˜ì—¬ ìœ„ "ë´‡ í† í°" í•„ë“œì— ë¶™ì—¬ë„£ê¸° â†’ <b>ì €ì¥</b> í´ë¦­</li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>2ë‹¨ê³„: Chat ID ì°¾ê¸°</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>í…”ë ˆê·¸ë¨ì—ì„œ ë°©ê¸ˆ ë§Œë“  ë´‡ì„ ì°¾ì•„ ì•„ë¬´ ë©”ì‹œì§€ë‚˜ ë³´ë‚´ê¸° (ì˜ˆ: <code>ì•ˆë…•</code>)</li>
            <li>ë¸Œë¼ìš°ì €ì—ì„œ ì•„ë˜ URL ì—´ê¸° (<code>&lt;TOKEN&gt;</code>ì„ ì‹¤ì œ í† í°ìœ¼ë¡œ êµì²´):<br>
              <code style="background:var(--bg2);padding:4px 8px;border-radius:4px;display:inline-block;margin:4px 0">https://api.telegram.org/bot<b>&lt;TOKEN&gt;</b>/getUpdates</code></li>
            <li>ì‘ë‹µì—ì„œ <code>"chat":{"id":<b>123456789</b></code> ë¶€ë¶„ ì°¾ê¸° â€” ì´ ìˆ«ìê°€ <b>Chat ID</b></li>
            <li>ìœ„ "ì†Œìœ ì Chat ID" í•„ë“œì— ë¶™ì—¬ë„£ê¸° â†’ <b>ì €ì¥</b> í´ë¦­</li>
          </ol>
          <div style="color:var(--accent);margin-top:4px">ğŸ’¡ <b>íŒ:</b> í…”ë ˆê·¸ë¨ì—ì„œ <a href="https://t.me/userinfobot" target="_blank" rel="noopener" style="color:var(--accent2)">@userinfobot</a>ì—ê²Œ ì•„ë¬´ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´ Chat IDë¥¼ ë°”ë¡œ ì•Œë ¤ì¤ë‹ˆë‹¤.</div>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>3ë‹¨ê³„: í™œì„±í™”</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>SalmAlm ì¬ì‹œì‘: í„°ë¯¸ë„ì„ ë‹«ê³  <code>salmalm</code> ë‹¤ì‹œ ì‹¤í–‰</li>
            <li>í…”ë ˆê·¸ë¨ì—ì„œ ë´‡ì—ê²Œ ë©”ì‹œì§€ ë³´ë‚´ê¸° â€” AI ì‘ë‹µì´ ì˜¤ë©´ ì„±ê³µ! ğŸ‰</li>
          </ol>
          <div style="color:var(--accent);margin-top:4px">ğŸ’¡ <b>ì°¸ê³ :</b> Owner Chat IDë§Œ ë´‡ê³¼ ëŒ€í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ë©”ì‹œì§€ëŠ” ë³´ì•ˆì„ ìœ„í•´ ë¬´ì‹œë©ë‹ˆë‹¤.</div>
        </div>
      </div>
    </details>
  </div>
  <div class="settings-card" id="discord-card">
    <h3>ğŸ® Discord Bot</h3>
    <p style="font-size:12px;color:var(--text2);margin-bottom:12px;line-height:1.6">
      <span data-i18n="dc-desc">Connect a Discord bot to chat with your AI in Discord servers.</span>
    </p>
    <label data-i18n="lbl-dc-token">Bot Token</label>
    <div style="display:flex;gap:6px"><input id="sk-discord-token" type="password" placeholder="MTIz..."><button class="btn" data-action="save-discord-token">Save</button></div>
    <label data-i18n="lbl-dc-guild">Server (Guild) ID <span style="font-size:11px;color:var(--text2)">(optional)</span></label>
    <div style="display:flex;gap:6px"><input id="sk-discord-guild" type="text" placeholder="123456789012345678"><button class="btn" data-action="save-discord-guild">Save</button></div>
    <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
      <span id="dc-conn-status" style="font-size:12px;color:var(--text2)">âšª <span data-i18n="dc-disconnected">Not connected</span></span>
    </div>
    <details style="margin-top:12px">
      <summary style="font-size:12px;color:var(--text2);cursor:pointer" data-i18n="dc-guide-title">ğŸ“‹ Setup Guide (click to expand)</summary>
      <div class="dc-guide-en" style="font-size:12px;color:var(--text2);margin-top:10px;line-height:2">
        <div style="background:#1a1a2e;border-radius:8px;padding:14px;border:1px solid var(--accent);margin-bottom:8px">
          <b>âš ï¸ Before you start: Create a Discord Server</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>In Discord, click the <b>+</b> button on the left sidebar</li>
            <li>Select <b>"Create My Own"</b> â†’ <b>"For me and my friends"</b></li>
            <li>Enter a server name (e.g. <code>AI Assistant</code>) â†’ <b>Create</b></li>
            <li>âœ… You'll invite the AI bot to this server!</li>
          </ol>
          <div style="color:var(--accent)">ğŸ’¡ Already have a server you want to add the bot to? Skip this step.</div>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border)">
          <b>Step 1: Create a Discord Application</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Go to <a href="https://discord.com/developers/applications" target="_blank" rel="noopener" style="color:var(--accent2)">discord.com/developers/applications</a> and log in</li>
            <li>Click the <b>New Application</b> button (top right)</li>
            <li>Enter a name (e.g. <code>SalmAlm AI</code>) â†’ check the ToS box â†’ click <b>Create</b></li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>Step 2: Get the Bot Token</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>In the left sidebar, click <b>Bot</b></li>
            <li>Click <b>Reset Token</b> â†’ confirm â†’ <b>copy the token</b> that appears</li>
            <li>âš ï¸ <b>Important:</b> This token is shown only once! Save it immediately.</li>
            <li>Paste it in the "Bot Token" field above â†’ click <b>Save</b></li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>Step 3: Enable Message Content Intent</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Still on the <b>Bot</b> page, scroll down to <b>Privileged Gateway Intents</b></li>
            <li>Turn ON: <b>Message Content Intent</b> â† <span style="color:#f87171">Required! Without this, the bot can't read messages.</span></li>
            <li>Click <b>Save Changes</b> at the bottom</li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>Step 4: Invite the Bot to Your Server</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Left sidebar â†’ <b>OAuth2</b> â†’ <b>URL Generator</b></li>
            <li>Under <b>Scopes</b>, check: <code>bot</code></li>
            <li>Under <b>Bot Permissions</b>, check:
              <ul style="padding-left:16px;margin:4px 0">
                <li>âœ… Send Messages</li>
                <li>âœ… Read Message History</li>
                <li>âœ… Attach Files (for images/file sharing)</li>
                <li>âœ… Add Reactions (optional, for emoji reactions)</li>
              </ul>
            </li>
            <li>Copy the <b>Generated URL</b> at the bottom</li>
            <li>Open it in your browser â†’ select your server â†’ click <b>Authorize</b></li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>Step 5: Get Server (Guild) ID <span style="font-weight:400">(optional but recommended)</span></b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>In Discord, go to <b>Settings â†’ Advanced â†’ Developer Mode</b> â†’ turn ON</li>
            <li>Right-click your server name â†’ <b>Copy Server ID</b></li>
            <li>Paste it in the "Server (Guild) ID" field above â†’ click <b>Save</b></li>
          </ol>
          <div style="color:var(--accent);margin-top:4px">ğŸ’¡ <b>Why?</b> Limits the bot to this server only. Without it, the bot responds in all servers it's in.</div>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>Step 6: Activate</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Restart SalmAlm: close the terminal and run <code>salmalm</code> again</li>
            <li>The bot should appear online in your server â€” send a message to test! ğŸ‰</li>
          </ol>
        </div>
      </div>
      <div class="dc-guide-kr" style="display:none;font-size:12px;color:var(--text2);margin-top:10px;line-height:2">
        <div style="background:#1a1a2e;border-radius:8px;padding:14px;border:1px solid var(--accent);margin-bottom:8px">
          <b>âš ï¸ ì‚¬ì „ ì¤€ë¹„: Discord ì„œë²„ ë§Œë“¤ê¸°</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Discord ì•±ì—ì„œ ì¢Œì¸¡ í•˜ë‹¨ <b>+</b> ë²„íŠ¼ í´ë¦­</li>
            <li><b>"ë‚´ ì„œë²„ ë§Œë“¤ê¸°"</b> â†’ <b>"ë‚˜ì™€ ì¹œêµ¬ë“¤ì„ ìœ„í•œ ì„œë²„"</b> ì„ íƒ</li>
            <li>ì„œë²„ ì´ë¦„ ì…ë ¥ (ì˜ˆ: <code>AI ë¹„ì„œ</code>) â†’ <b>ë§Œë“¤ê¸°</b></li>
            <li>âœ… ì´ ì„œë²„ì— AI ë´‡ì„ ì´ˆëŒ€í•  ê²ƒì…ë‹ˆë‹¤!</li>
          </ol>
          <div style="color:var(--accent)">ğŸ’¡ ì´ë¯¸ ë´‡ì„ ë„£ê³  ì‹¶ì€ ì„œë²„ê°€ ìˆë‹¤ë©´ ì´ ë‹¨ê³„ë¥¼ ê±´ë„ˆë›°ì„¸ìš”.</div>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border)">
          <b>1ë‹¨ê³„: Discord ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li><a href="https://discord.com/developers/applications" target="_blank" rel="noopener" style="color:var(--accent2)">discord.com/developers/applications</a> ì ‘ì† í›„ ë¡œê·¸ì¸</li>
            <li>ì˜¤ë¥¸ìª½ ìƒë‹¨ <b>New Application</b> ë²„íŠ¼ í´ë¦­</li>
            <li>ì´ë¦„ ì…ë ¥ (ì˜ˆ: <code>ì‚¶ì• AI</code>) â†’ ì•½ê´€ ë™ì˜ ì²´í¬ â†’ <b>Create</b> í´ë¦­</li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>2ë‹¨ê³„: ë´‡ í† í° ë°œê¸‰</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>ì¢Œì¸¡ ë©”ë‰´ì—ì„œ <b>Bot</b> í´ë¦­</li>
            <li><b>Reset Token</b> í´ë¦­ â†’ í™•ì¸ â†’ ë‚˜íƒ€ë‚˜ëŠ” <b>í† í°ì„ ë³µì‚¬</b></li>
            <li>âš ï¸ <b>ì¤‘ìš”:</b> í† í°ì€ í•œ ë²ˆë§Œ í‘œì‹œë©ë‹ˆë‹¤! ì¦‰ì‹œ ì €ì¥í•˜ì„¸ìš”.</li>
            <li>ìœ„ "ë´‡ í† í°" í•„ë“œì— ë¶™ì—¬ë„£ê¸° â†’ <b>ì €ì¥</b> í´ë¦­</li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>3ë‹¨ê³„: Message Content Intent í™œì„±í™”</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li><b>Bot</b> í˜ì´ì§€ì—ì„œ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤ â†’ <b>Privileged Gateway Intents</b> ì„¹ì…˜</li>
            <li><b>Message Content Intent</b> ì¼œê¸° â† <span style="color:#f87171">í•„ìˆ˜! ì´ê±¸ ì•ˆ ì¼œë©´ ë´‡ì´ ë©”ì‹œì§€ë¥¼ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span></li>
            <li>í•˜ë‹¨ <b>Save Changes</b> í´ë¦­</li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>4ë‹¨ê³„: ì„œë²„ì— ë´‡ ì´ˆëŒ€</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>ì¢Œì¸¡ ë©”ë‰´ â†’ <b>OAuth2</b> â†’ <b>URL Generator</b></li>
            <li><b>Scopes</b>ì—ì„œ ì²´í¬: <code>bot</code></li>
            <li><b>Bot Permissions</b>ì—ì„œ ì²´í¬:
              <ul style="padding-left:16px;margin:4px 0">
                <li>âœ… Send Messages (ë©”ì‹œì§€ ì „ì†¡)</li>
                <li>âœ… Read Message History (ë©”ì‹œì§€ ê¸°ë¡ ì½ê¸°)</li>
                <li>âœ… Attach Files (íŒŒì¼ ì²¨ë¶€ â€” ì´ë¯¸ì§€/íŒŒì¼ ê³µìœ ìš©)</li>
                <li>âœ… Add Reactions (ë°˜ì‘ ì¶”ê°€ â€” ì„ íƒì‚¬í•­)</li>
              </ul>
            </li>
            <li>í•˜ë‹¨ì˜ <b>Generated URL</b> ë³µì‚¬</li>
            <li>ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸° â†’ ì„œë²„ ì„ íƒ â†’ <b>ìŠ¹ì¸(Authorize)</b> í´ë¦­</li>
          </ol>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>5ë‹¨ê³„: ì„œë²„ (Guild) ID ì„¤ì • <span style="font-weight:400">(ì„ íƒì‚¬í•­ì´ì§€ë§Œ ê¶Œì¥)</span></b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>Discordì—ì„œ <b>ì„¤ì • â†’ ê³ ê¸‰ â†’ ê°œë°œì ëª¨ë“œ</b> â†’ ì¼œê¸°</li>
            <li>ì„œë²„ ì´ë¦„ ìš°í´ë¦­ â†’ <b>ì„œë²„ ID ë³µì‚¬</b></li>
            <li>ìœ„ "ì„œë²„ (Guild) ID" í•„ë“œì— ë¶™ì—¬ë„£ê¸° â†’ <b>ì €ì¥</b> í´ë¦­</li>
          </ol>
          <div style="color:var(--accent);margin-top:4px">ğŸ’¡ <b>ì™œ í•„ìš”í•œê°€ìš”?</b> ë´‡ì„ ì´ ì„œë²„ì—ì„œë§Œ ì‘ë™í•˜ë„ë¡ ì œí•œí•©ë‹ˆë‹¤. ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ë´‡ì´ ì´ˆëŒ€ëœ ëª¨ë“  ì„œë²„ì—ì„œ ì‘ë‹µí•©ë‹ˆë‹¤.</div>
        </div>
        <div style="background:var(--bg);border-radius:8px;padding:14px;border:1px solid var(--border);margin-top:8px">
          <b>6ë‹¨ê³„: í™œì„±í™”</b>
          <ol style="padding-left:20px;margin:8px 0">
            <li>SalmAlm ì¬ì‹œì‘: í„°ë¯¸ë„ì„ ë‹«ê³  <code>salmalm</code> ë‹¤ì‹œ ì‹¤í–‰</li>
            <li>ë´‡ì´ ì„œë²„ì—ì„œ ì˜¨ë¼ì¸ìœ¼ë¡œ í‘œì‹œë˜ë©´ ì„±ê³µ â€” ë©”ì‹œì§€ë¥¼ ë³´ë‚´ í…ŒìŠ¤íŠ¸! ğŸ‰</li>
          </ol>
        </div>
      </div>
    </details>
  </div>
  <div class="settings-card" id="soul-card">
    <h3 data-i18n="h-soul">ğŸ“œ SOUL.md (Custom System Prompt)</h3>
    <p style="font-size:12px;color:var(--text2);margin-bottom:8px;line-height:1.6">
      <span data-i18n="soul-desc">Set a custom system prompt. It will be prepended to all conversations.</span><br>
      <code style="font-size:11px" data-i18n="soul-path">~/.salmalm/SOUL.md Â· Leave empty to restore default</code>
    </p>
    <textarea id="soul-editor" style="width:100%;min-height:150px;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px;font-family:'SF Mono',monospace;resize:vertical;line-height:1.6" placeholder="# My Custom Persona\n\nYou are ..."></textarea>
    <div style="display:flex;gap:8px;margin-top:8px">
      <button class="btn" data-action="saveSoul" data-i18n="btn-save-soul">ğŸ’¾ Save</button>
      <button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="resetSoul" data-i18n="btn-reset-soul">ğŸ”„ Reset</button>
    </div>
    <div id="soul-result" style="margin-top:6px;font-size:12px"></div>
  </div>
  <div class="settings-card" id="usage-card">
    <h3data-i18n="h-usage">ğŸ“Š Token Usage</h3>
    <div id="usage-detail"></div>
  </div>
  <div class="settings-card">
    <h3 data-i18n="h-password">ğŸ”’ ë§ˆìŠ¤í„° ë¹„ë°€ë²ˆí˜¸</h3>
    <div id="pw-section-change">
      <label data-i18n="pw-current">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
      <input type="password" id="pw-old" data-i18n-ph="pw-current" placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸">
      <label data-i18n="pw-new">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
      <input type="password" id="pw-new" data-i18n-ph="pw-new-hint" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ (4ì ì´ìƒ, ë¹„ìš°ë©´ í•´ì œ)">
      <label data-i18n="pw-confirm">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
      <input type="password" id="pw-confirm" data-i18n-ph="pw-confirm-hint" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ ë‹¤ì‹œ ì…ë ¥">
      <div style="display:flex;gap:8px;margin-top:4px">
        <button class="btn" data-action="changePw" data-i18n="pw-change">ë³€ê²½</button>
        <button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="removePw" data-i18n="pw-remove">ë¹„ë°€ë²ˆí˜¸ í•´ì œ</button>
      </div>
    </div>
    <div id="pw-section-set" style="display:none">
      <p style="font-size:13px;color:var(--text2);margin-bottom:12px" data-i18n="pw-not-set">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
      <label data-i18n="pw-new">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
      <input type="password" id="pw-set-new" data-i18n-ph="pw-min4" placeholder="ë¹„ë°€ë²ˆí˜¸ (4ì ì´ìƒ)">
      <label data-i18n="pw-confirm">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
      <input type="password" id="pw-set-confirm" data-i18n-ph="pw-reenter" placeholder="ë‹¤ì‹œ ì…ë ¥">
      <button class="btn" data-action="setPw" data-i18n="pw-set">ë¹„ë°€ë²ˆí˜¸ ì„¤ì •</button>
    </div>
    <div id="pw-result" style="margin-top:8px;font-size:12px"></div>
  </div>
  <div class="settings-card" id="users-card">
    <h3>ğŸ‘¥ Users / ì‚¬ìš©ì ê´€ë¦¬</h3>
    <div id="users-panel">
      <div style="display:flex;gap:12px;margin-bottom:16px;align-items:center;flex-wrap:wrap">
        <label style="font-size:13px;margin:0;display:flex;align-items:center;gap:6px"><input type="checkbox" id="mt-toggle" style="width:16px;height:16px"> Multi-tenant / ë©€í‹°í…Œë„ŒíŠ¸</label>
        <select id="reg-mode" style="width:auto;margin:0;padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
          <option value="admin_only">Admin-only registration</option>
          <option value="open">Open registration</option>
        </select>
      </div>
      <div id="user-list" style="font-size:13px;color:var(--text2);margin-bottom:16px;padding:8px 12px;background:var(--bg);border-radius:8px;border:1px solid var(--border)">Loading...</div>
      <h4 style="font-size:13px;margin-bottom:8px;color:var(--text2)">â• Add User</h4>
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <input id="new-user-name" placeholder="Username" style="width:140px;margin:0;padding:8px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
        <input id="new-user-pw" type="password" placeholder="Password" style="width:140px;margin:0;padding:8px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
        <select id="new-user-role" style="width:auto;margin:0;padding:8px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
          <option value="user">user</option>
          <option value="admin">admin</option>
        </select>
        <button class="btn" data-action="createUser">+ Create</button>
      </div>
    </div>
  </div>
  <div class="settings-card" id="migration-card">
    <h3>ğŸ“¦ Agent Migration / ì—ì´ì „íŠ¸ ì´ë™</h3>
    <p style="font-size:12px;color:var(--text2);margin-bottom:12px">Export or import your agent's personality, memory, settings, and data.<br>ì—ì´ì „íŠ¸ì˜ ì¸ê²©, ê¸°ì–µ, ì„¤ì •, ë°ì´í„°ë¥¼ ë‚´ë³´ë‚´ê±°ë‚˜ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>
    <div style="margin-bottom:12px">
      <strong style="font-size:12px;color:var(--text)">Export / ë‚´ë³´ë‚´ê¸°</strong>
      <div style="display:flex;flex-wrap:wrap;gap:8px;margin:8px 0">
        <label style="font-size:11px;display:flex;align-items:center;gap:4px"><input type="checkbox" id="exp-sessions" checked> Sessions</label>
        <label style="font-size:11px;display:flex;align-items:center;gap:4px"><input type="checkbox" id="exp-data" checked> Data (notes/expenses)</label>
        <label style="font-size:11px;display:flex;align-items:center;gap:4px"><input type="checkbox" id="exp-vault"> Vault (API keys)</label>
      </div>
      <button class="btn" data-action="exportAgent" style="font-size:12px">ğŸ“¥ Export Agent</button>
      <button class="btn" data-action="quickSyncExport" style="background:var(--bg3);color:var(--text2);font-size:12px;margin-left:4px">âš¡ Quick Sync</button>
    </div>
    <div style="border-top:1px solid var(--border);padding-top:12px">
      <strong style="font-size:12px;color:var(--text)">Import / ê°€ì ¸ì˜¤ê¸°</strong>
      <div id="import-dropzone" data-action="triggerImportFile" style="border:2px dashed var(--border);border-radius:8px;padding:20px;text-align:center;margin:8px 0;cursor:pointer;transition:border-color 0.2s">
        <p style="font-size:13px;color:var(--text2);margin:0">ğŸ“‚ Drop ZIP file here or click to browse<br>ZIP íŒŒì¼ì„ ì—¬ê¸°ì— ë†“ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</p>
        <input type="file" id="import-file-input" accept=".zip" style="display:none">
      </div>
      <div id="import-preview" style="display:none;font-size:12px;color:var(--text2);margin:8px 0;padding:8px;background:var(--bg);border-radius:6px"></div>
      <div style="display:flex;gap:8px;align-items:center">
        <select id="import-mode" style="padding:6px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:12px">
          <option value="overwrite">Overwrite / ë®ì–´ì“°ê¸°</option>
          <option value="merge">Merge / ë³‘í•©</option>
          <option value="skip">Skip existing / ê±´ë„ˆë›°ê¸°</option>
        </select>
        <button class="btn" id="import-btn" data-action="importAgent" style="font-size:12px" disabled>ğŸ“¤ Import Agent</button>
      </div>
      <div id="import-result" style="margin-top:8px;font-size:12px"></div>
    </div>
  </div>
  <div class="settings-card">
    <h3 data-i18n="h-update">ğŸ”„ Update</h3>
    <div style="display:flex;gap:8px;align-items:center">
      <span id="update-ver" style="font-size:13px;color:var(--text2)">Current: v<span id="cur-ver"></span></span>
      <button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="checkUpdate"data-i18n="btn-check">Check for Updates</button>
      <button class="btn" id="do-update-btn" style="display:none" data-action="doUpdate">â¬†ï¸ Update</button>
    </div>
    <div id="update-result" style="margin-top:8px;font-size:12px"></div>
  </div>
  </div><!-- end settings-general -->
  <div id="settings-features" style="display:none">
    <div class="settings-card" id="engine-opt-card">
      <h3><span class="eng-en">âš¡ Engine Optimization</span><span class="eng-kr">âš¡ ì—”ì§„ ìµœì í™”</span></h3>
      <p style="font-size:12px;color:var(--text2);margin-bottom:8px;line-height:1.8">
        <span class="eng-en">Control how SalmAlm balances <b>cost</b> vs <b>quality</b>. All changes take effect immediately without restart.</span>
        <span class="eng-kr">ì‚¶ì•ì˜ <b>ë¹„ìš©</b>ê³¼ <b>í’ˆì§ˆ</b> ê· í˜•ì„ ì¡°ì ˆí•©ë‹ˆë‹¤. ëª¨ë“  ë³€ê²½ì€ ì¬ì‹œì‘ ì—†ì´ ì¦‰ì‹œ ì ìš©ë©ë‹ˆë‹¤.</span>
      </p>
      <div style="background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:14px;margin-bottom:16px;font-size:12px;color:var(--text2);line-height:1.8">
        <span class="eng-en">ğŸ“Š <b>Cost Breakdown</b><br>
        Every LLM call includes: <b>System Prompt</b> (~310 tok) + <b>Tool Schemas</b> (0~700 tok) + <b>Chat History</b> (varies) + <b>Your Message</b></span>
        <span class="eng-kr">ğŸ“Š <b>ë¹„ìš© êµ¬ì¡°</b><br>
        ë§¤ LLM í˜¸ì¶œì— í¬í•¨: <b>ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸</b> (~310 í† í°) + <b>ë„êµ¬ ìŠ¤í‚¤ë§ˆ</b> (0~700 í† í°) + <b>ëŒ€í™” íˆìŠ¤í† ë¦¬</b> (ê°€ë³€) + <b>ì‚¬ìš©ì ë©”ì‹œì§€</b></span><br>
        <span style="color:var(--accent)">ğŸ’¡ Opus: $15/1M input, $75/1M output Â· Sonnet: $3/$15 Â· Haiku: $0.25/$1.25</span>
      </div>

      <div style="display:flex;flex-direction:column;gap:20px">

        <!-- Dynamic Tool Loading (always ON) -->
        <div style="border-left:3px solid #4ade80;padding-left:14px">
          <div style="font-size:14px;display:flex;align-items:center;gap:10px;margin-bottom:6px">
            <span style="color:#4ade80;font-size:18px">âœ…</span>
            <span class="eng-en"><b>ğŸ”§ Dynamic Tool Loading</b> â€” Always ON</span><span class="eng-kr"><b>ğŸ”§ ë™ì  ë„êµ¬ ë¡œë”©</b> â€” í•­ìƒ ì¼œì§</span>
          </div>
          <div style="font-size:12px;color:var(--text2);line-height:1.8;padding-left:28px">
            <span class="eng-en">Only sends relevant tools based on message intent. Saves <b>~$10/day</b> vs sending all 62 tools every call.<br>
            Chat â†’ <span style="color:#4ade80">0 tools</span> Â· Weather/calendar â†’ <span style="color:#facc15">7-12 tools</span> Â· Coding â†’ <span style="color:#f97316">11 tools</span></span>
            <span class="eng-kr">ë©”ì‹œì§€ ì˜ë„ì— ë”°ë¼ í•„ìš”í•œ ë„êµ¬ë§Œ ì „ì†¡. ë§¤ë²ˆ 62ê°œ ì „ì†¡ ëŒ€ë¹„ <b>~$10/day ì ˆê°</b>.<br>
            ì¡ë‹´ â†’ <span style="color:#4ade80">0ê°œ</span> Â· ë‚ ì”¨/ì¼ì • â†’ <span style="color:#facc15">7-12ê°œ</span> Â· ì½”ë”© â†’ <span style="color:#f97316">11ê°œ</span></span>
          </div>
        </div>

        <!-- Planning Phase -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <label style="font-size:14px;display:flex;align-items:center;gap:10px;cursor:pointer;margin-bottom:6px">
            <input type="checkbox" id="eng-planning" style="width:18px;height:18px">
            <span class="eng-en"><b>ğŸ“‹ Planning Phase</b></span><span class="eng-kr"><b>ğŸ“‹ ê³„íš ë‹¨ê³„</b></span>
          </label>
          <div style="font-size:12px;color:var(--text2);line-height:1.8;padding-left:28px">
            <span class="eng-en"><b>ON:</b> Before complex code/analysis tasks, injects a planning prompt that asks the AI to outline its approach before executing. Can improve accuracy for multi-step tasks.<br>
            <b>Cost:</b> <span style="color:#f97316">+~150 input tokens per complex request</span> (~$0.002/call on Opus)<br>
            <b>OFF (default):</b> AI plans naturally within its response. Sufficient for most tasks.</span>
            <span class="eng-kr"><b>ON:</b> ë³µì¡í•œ ì½”ë“œ/ë¶„ì„ ì‘ì—… ì „ì— AIê°€ ì ‘ê·¼ ë°©ë²•ì„ ë¨¼ì € ê³„íší•˜ë„ë¡ í”„ë¡¬í”„íŠ¸ë¥¼ ì£¼ì…í•©ë‹ˆë‹¤. ë‹¤ë‹¨ê³„ ì‘ì—…ì˜ ì •í™•ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
            <b>ë¹„ìš©:</b> <span style="color:#f97316">ë³µì¡í•œ ìš”ì²­ë‹¹ +~150 ì…ë ¥ í† í°</span> (Opus ê¸°ì¤€ ~$0.002/í˜¸ì¶œ)<br>
            <b>OFF (ê¸°ë³¸):</b> AIê°€ ì‘ë‹µ ë‚´ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ê³„íší•©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì‘ì—…ì— ì¶©ë¶„í•©ë‹ˆë‹¤.</span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Planning <b>OFF</b>. Uses "extended thinking" mode instead â€” model plans internally.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> Planning <b>OFF</b>. ë³„ë„ ê³„íš ë‹¨ê³„ ì—†ì´ "í™•ì¥ ì‚¬ê³ (reasoning)" ëª¨ë“œë¡œ ëª¨ë¸ì´ ë‚´ë¶€ì—ì„œ ê³„íš.</span></span>
          </div>
        </div>

        <!-- Self-Reflection -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <label style="font-size:14px;display:flex;align-items:center;gap:10px;cursor:pointer;margin-bottom:6px">
            <input type="checkbox" id="eng-reflection" style="width:18px;height:18px">
            <span class="eng-en"><b>ğŸ” Self-Reflection</b></span><span class="eng-kr"><b>ğŸ” ìê¸° ê²€ì¦</b></span>
          </label>
          <div style="font-size:12px;color:var(--text2);line-height:1.8;padding-left:28px">
            <span class="eng-en"><b>ON:</b> After generating code or analysis, makes a <b>second full LLM call</b> to review and improve the response. Catches bugs, hallucinations, and incomplete answers.<br>
            <b>Cost:</b> <span style="color:#f87171">Doubles the cost for complex tasks</span> (2x LLM calls). E.g., a coding response that costs $0.05 â†’ $0.10.<br>
            <b>Best for:</b> Production code, security audits, critical analysis where accuracy matters more than speed.<br>
            <b>OFF (default):</b> Single-pass generation. Faster and cheaper. Quality is still good for most tasks.</span>
            <span class="eng-kr"><b>ON:</b> ì½”ë“œ/ë¶„ì„ ìƒì„± í›„ <b>ë‘ ë²ˆì§¸ LLM í˜¸ì¶œ</b>ë¡œ ì‘ë‹µì„ ê²€í† í•˜ê³  ê°œì„ í•©ë‹ˆë‹¤. ë²„ê·¸, í™˜ê°, ë¶ˆì™„ì „í•œ ë‹µë³€ì„ ì¡ì•„ëƒ…ë‹ˆë‹¤.<br>
            <b>ë¹„ìš©:</b> <span style="color:#f87171">ë³µì¡í•œ ì‘ì—… ë¹„ìš© 2ë°°</span> (LLM 2íšŒ í˜¸ì¶œ). ì˜ˆ: $0.05 ì½”ë”© ì‘ë‹µ â†’ $0.10<br>
            <b>ì¶”ì²œ ìƒí™©:</b> í”„ë¡œë•ì…˜ ì½”ë“œ, ë³´ì•ˆ ê°ì‚¬, ì •í™•ë„ê°€ ì†ë„ë³´ë‹¤ ì¤‘ìš”í•œ ë¶„ì„<br>
            <b>OFF (ê¸°ë³¸):</b> ë‹¨ì¼ íŒ¨ìŠ¤ ìƒì„±. ë” ë¹ ë¥´ê³  ì €ë ´í•©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì‘ì—…ì— ì¶©ë¶„í•œ í’ˆì§ˆ.</span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Reflection <b>OFF</b>. Single-pass response. Extended thinking serves as built-in quality check.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> Reflection <b>OFF</b>. ë‘ ë²ˆì§¸ ê²€ì¦ í˜¸ì¶œ ì—†ì´ í•œ ë²ˆì— ë‹µë³€. í™•ì¥ ì‚¬ê³  ëª¨ë“œê°€ ê²€ì¦ ì—­í• ì„ ëŒ€ì‹ .</span></span>
          </div>
        </div>

        <!-- Compaction Threshold -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
            <span class="eng-en"><span style="font-size:14px"><b>ğŸ“¦ Compaction Threshold</b></span></span><span class="eng-kr"><span style="font-size:14px"><b>ğŸ“¦ ì»¨í…ìŠ¤íŠ¸ ì••ì¶• ì„ê³„ê°’</b></span></span>
          </div>
          <div style="margin-bottom:8px">
            <select id="eng-compaction" style="width:auto;padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
              <option value="15000">Aggressive (15K)</option>
              <option value="30000" selected>Balanced (30K)</option>
              <option value="60000">Relaxed (60K)</option>
              <option value="120000">Maximum (120K)</option>
            </select>
          </div>
          <div style="font-size:12px;color:var(--text2);line-height:1.8">
            <span class="eng-en">Controls when old messages are summarized to free up context space. Lower = more frequent compaction = lower cost per turn but may lose details.<br>
            <b>15K (Aggressive):</b> Compacts often. Best for cost savings. <span style="color:#4ade80">~$0.01/turn avg on Opus</span><br>
            <b>30K (Balanced):</b> Good middle ground. <span style="color:#facc15">~$0.02/turn avg</span><br>
            <b>60K (Relaxed):</b> Keeps more history. <span style="color:#f97316">~$0.04/turn avg</span><br>
            <b>120K (Maximum):</b> Full context retention. Best for long coding sessions. <span style="color:#f87171">~$0.08/turn avg</span></span>
            <span class="eng-kr">ì´ì „ ë©”ì‹œì§€ë¥¼ ìš”ì•½í•˜ì—¬ ì»¨í…ìŠ¤íŠ¸ ê³µê°„ì„ í™•ë³´í•˜ëŠ” ì‹œì ì„ ì œì–´í•©ë‹ˆë‹¤. ë‚®ì„ìˆ˜ë¡ ë” ìì£¼ ì••ì¶• = í„´ë‹¹ ë¹„ìš© ì ˆê°, ì„¸ë¶€ì‚¬í•­ ì†ì‹¤ ê°€ëŠ¥.<br>
            <b>15K (ì ê·¹ì ):</b> ìì£¼ ì••ì¶•. ë¹„ìš© ì ˆê° ìµœì . <span style="color:#4ade80">Opus ê¸°ì¤€ í„´ë‹¹ í‰ê·  ~$0.01</span><br>
            <b>30K (ê· í˜•):</b> ì ì ˆí•œ ì¤‘ê°„ê°’. <span style="color:#facc15">í„´ë‹¹ í‰ê·  ~$0.02</span><br>
            <b>60K (ì—¬ìœ ):</b> ë” ë§ì€ íˆìŠ¤í† ë¦¬ ìœ ì§€. <span style="color:#f97316">í„´ë‹¹ í‰ê·  ~$0.04</span><br>
            <b>120K (ìµœëŒ€):</b> ì „ì²´ ì»¨í…ìŠ¤íŠ¸ ìœ ì§€. ê¸´ ì½”ë”© ì„¸ì…˜ì— ì í•©. <span style="color:#f87171">í„´ë‹¹ í‰ê·  ~$0.08</span></span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Auto-compaction <b>ON</b>, threshold fixed internally (~<b>60-120K</b>). Not user-configurable.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> ìë™ ì••ì¶• <b>ON</b>, ì„ê³„ê°’ì€ ë‚´ë¶€ ê³ ì • (ì‚¬ìš©ì ì¡°ì ˆ ë¶ˆê°€). ëŒ€ëµ <b>60-120K</b> ìˆ˜ì¤€.</span></span>
          </div>
        </div>

        <!-- Max Tool Iterations -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
            <span class="eng-en"><span style="font-size:14px"><b>ğŸ”„ Max Tool Iterations</b></span></span><span class="eng-kr"><span style="font-size:14px"><b>ğŸ”„ ìµœëŒ€ ë„êµ¬ ë°˜ë³µ íšŸìˆ˜</b></span></span>
          </div>
          <div style="margin-bottom:8px">
            <select id="eng-max-tool-iter" style="width:auto;padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
              <option value="5">Conservative (5)</option>
              <option value="10">Moderate (10)</option>
              <option value="15" selected>Default (15)</option>
              <option value="25">Extended (25)</option>
              <option value="40">Maximum (40)</option>
              <option value="999">â™¾ï¸ Unlimited (OpenClaw style)</option>
            </select>
          </div>
          <div style="font-size:12px;color:var(--text2);line-height:1.8">
            <span class="eng-en">Maximum number of tool calls the AI can make in a single response. When reached, the AI stops and returns "Reached maximum tool iterations."<br>
            Higher values allow complex multi-step tasks (file editing, multi-search) to complete, but cost more tokens per turn.<br>
            <b>5 (Conservative):</b> Simple tasks only. Limits runaway loops. <span style="color:#4ade80">Cheapest â€” caps output at ~2K tok/turn</span><br>
            <b>10 (Moderate):</b> Most coding tasks complete. <span style="color:#facc15">~4K tok/turn max</span><br>
            <b>15 (Default):</b> Good balance â€” handles multi-file edits. <span style="color:#f97316">~6K tok/turn max</span><br>
            <b>25 (Extended):</b> Complex refactoring, multi-tool chains. <span style="color:#f87171">~10K tok/turn max</span><br>
            <b>40 (Maximum):</b> Long autonomous coding sessions. <span style="color:#f87171">~16K tok/turn max â€” expensive!</span></span>
            <span class="eng-kr">AIê°€ í•œ ë²ˆì˜ ì‘ë‹µì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ ë„êµ¬ í˜¸ì¶œ íšŸìˆ˜ì…ë‹ˆë‹¤. ë„ë‹¬ ì‹œ "Reached maximum tool iterations" ë©”ì‹œì§€ì™€ í•¨ê»˜ ì¤‘ë‹¨ë©ë‹ˆë‹¤.<br>
            ë†’ì„ìˆ˜ë¡ ë³µì¡í•œ ë‹¤ë‹¨ê³„ ì‘ì—…(íŒŒì¼ í¸ì§‘, ë‹¤ì¤‘ ê²€ìƒ‰)ì´ ì™„ë£Œë˜ì§€ë§Œ, í„´ë‹¹ í† í° ë¹„ìš©ì´ ì¦ê°€í•©ë‹ˆë‹¤.<br>
            <b>5 (ë³´ìˆ˜ì ):</b> ë‹¨ìˆœ ì‘ì—…ë§Œ. í­ì£¼ ë£¨í”„ ë°©ì§€. <span style="color:#4ade80">ìµœì € ë¹„ìš©</span><br>
            <b>10 (ë³´í†µ):</b> ëŒ€ë¶€ë¶„ì˜ ì½”ë”© ì‘ì—… ì™„ë£Œ ê°€ëŠ¥. <span style="color:#facc15">í„´ë‹¹ ìµœëŒ€ ~4K í† í°</span><br>
            <b>15 (ê¸°ë³¸):</b> ì ì ˆí•œ ê· í˜• â€” ë©€í‹° íŒŒì¼ í¸ì§‘ ì²˜ë¦¬ ê°€ëŠ¥. <span style="color:#f97316">í„´ë‹¹ ìµœëŒ€ ~6K í† í°</span><br>
            <b>25 (í™•ì¥):</b> ë³µì¡í•œ ë¦¬íŒ©í† ë§, ë‹¤ì¤‘ ë„êµ¬ ì²´ì¸. <span style="color:#f87171">í„´ë‹¹ ìµœëŒ€ ~10K í† í°</span><br>
            <b>40 (ìµœëŒ€):</b> ê¸´ ììœ¨ ì½”ë”© ì„¸ì…˜. <span style="color:#f87171">í„´ë‹¹ ìµœëŒ€ ~16K í† í° â€” ë¹„ìš© ì£¼ì˜!</span></span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> <b>â™¾ï¸ Unlimited</b>. AI uses tools until it decides to stop. Internal loop detection only.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> <b>â™¾ï¸ ë¬´ì œí•œ</b>. AIê°€ ìŠ¤ìŠ¤ë¡œ ë©ˆì¶œ ë•Œê¹Œì§€ ë„êµ¬ ì‚¬ìš©. ë¬´í•œ ë£¨í”„ë§Œ ë‚´ë¶€ ê°ì§€ë¡œ ë°©ì§€.</span></span>
          </div>
        </div>

        <!-- Cost Cap -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
            <span class="eng-en"><span style="font-size:14px"><b>ğŸ’¸ Daily Cost Cap</b></span></span><span class="eng-kr"><span style="font-size:14px"><b>ğŸ’¸ ì¼ì¼ ë¹„ìš© í•œë„</b></span></span>
          </div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px">
            <span style="font-size:14px">$</span>
            <input id="eng-cost-cap" type="text" placeholder="e.g. 5.00" style="width:100px;padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:14px">
            <span style="font-size:12px;color:var(--text2)">/ day</span>
          </div>
          <div style="font-size:12px;color:var(--text2);line-height:1.8">
            <span class="eng-en">When daily spending reaches this limit, the AI will stop processing new requests until the next day (UTC reset). Leave empty for no limit.<br>
            <b>Suggested values:</b> Casual use: <span style="color:#4ade80">$1-2/day</span> Â· Active use: <span style="color:#facc15">$5-10/day</span> Â· Heavy dev: <span style="color:#f97316">$20-50/day</span></span>
            <span class="eng-kr">ì¼ì¼ ë¹„ìš©ì´ ì´ í•œë„ì— ë„ë‹¬í•˜ë©´ ë‹¤ìŒ ë‚ (UTC ê¸°ì¤€)ê¹Œì§€ ìƒˆ ìš”ì²­ ì²˜ë¦¬ë¥¼ ì¤‘ë‹¨í•©ë‹ˆë‹¤. ë¹„ì›Œë‘ë©´ ì œí•œ ì—†ìŒ.<br>
            <b>ê¶Œì¥ê°’:</b> ê°€ë²¼ìš´ ì‚¬ìš©: <span style="color:#4ade80">$1-2/ì¼</span> Â· í™œë°œí•œ ì‚¬ìš©: <span style="color:#facc15">$5-10/ì¼</span> Â· ì§‘ì¤‘ ê°œë°œ: <span style="color:#f97316">$20-50/ì¼</span></span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Daily cap <b>none</b>. Manual monitoring via <code>/status</code> only.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> ì¼ì¼ í•œë„ <b>ì—†ìŒ</b>. <code>/status</code>ë¡œ ìˆ˜ë™ í™•ì¸ë§Œ ê°€ëŠ¥.</span></span>
          </div>
        </div>

        <!-- Cache TTL -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
            <span class="eng-en"><span style="font-size:14px"><b>ğŸ—„ï¸ Response Cache TTL</b></span></span><span class="eng-kr"><span style="font-size:14px"><b>ğŸ—„ï¸ ì‘ë‹µ ìºì‹œ ìœ íš¨ì‹œê°„</b></span></span>
          </div>
          <div style="margin-bottom:8px">
            <select id="eng-cache-ttl" style="width:auto;padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
              <option value="0">Disabled (0)</option>
              <option value="1800">30 min</option>
              <option value="3600" selected>1 hour</option>
              <option value="14400">4 hours</option>
              <option value="43200">12 hours</option>
              <option value="86400">24 hours</option>
            </select>
          </div>
          <div style="font-size:12px;color:var(--text2);line-height:1.8">
            <span class="eng-en">How long identical (tool-free) query responses are cached. Cached hits cost <span style="color:#4ade80">$0</span> â€” no API call made.<br>
            Higher TTL = more cache hits = more savings, but responses may be stale.<br>
            <b>Recommended:</b> 4-24h for general use. Disable for real-time data needs (weather, stocks).</span>
            <span class="eng-kr">ë™ì¼í•œ (ë„êµ¬ ë¯¸ì‚¬ìš©) ì¿¼ë¦¬ ì‘ë‹µì„ ìºì‹œí•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤. ìºì‹œ íˆíŠ¸ ì‹œ ë¹„ìš© <span style="color:#4ade80">$0</span> â€” API í˜¸ì¶œ ì—†ìŒ.<br>
            TTLì´ ë†’ì„ìˆ˜ë¡ ìºì‹œ íˆíŠ¸ ì¦ê°€ = ë¹„ìš© ì ˆê°, ë‹¨ ì‘ë‹µì´ ì˜¤ë˜ë  ìˆ˜ ìˆìŒ.<br>
            <b>ê¶Œì¥:</b> ì¼ë°˜ ì‚¬ìš© 4-24ì‹œê°„. ì‹¤ì‹œê°„ ë°ì´í„°(ë‚ ì”¨, í™˜ìœ¨) í•„ìš” ì‹œ ë¹„í™œì„±í™”.</span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Response cache <b>OFF</b>. Every message = fresh API call. (SalmAlm exclusive)</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> ì‘ë‹µ ìºì‹œ <b>OFF</b>. ê°™ì€ ì§ˆë¬¸ë„ ë§¤ë²ˆ ìƒˆ API í˜¸ì¶œ. (ì‚¶ì• ì „ìš© ê¸°ëŠ¥)</span></span>
          </div>
        </div>

        <!-- Batch API -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <label style="font-size:14px;display:flex;align-items:center;gap:10px;cursor:pointer;margin-bottom:6px">
            <input type="checkbox" id="eng-batch-api" style="width:18px;height:18px">
            <span class="eng-en"><b>ğŸ“¦ Batch API Mode</b></span><span class="eng-kr"><b>ğŸ“¦ ë°°ì¹˜ API ëª¨ë“œ</b></span>
          </label>
          <div style="font-size:12px;color:var(--text2);line-height:1.8;padding-left:28px">
            <span class="eng-en"><b>ON:</b> Non-interactive tasks (summaries, analysis, translations) are queued and sent via Anthropic Batch API at <span style="color:#4ade80">50% discount</span>. Responses may take 1-60 min instead of instant.<br>
            <b>Best for:</b> Batch processing, document analysis, offline summarization.<br>
            <b>OFF (default):</b> All requests processed in real-time.</span>
            <span class="eng-kr"><b>ON:</b> ë¹„ëŒ€í™”í˜• ì‘ì—…(ìš”ì•½, ë¶„ì„, ë²ˆì—­)ì„ Anthropic ë°°ì¹˜ APIë¡œ ì „ì†¡í•˜ì—¬ <span style="color:#4ade80">50% í• ì¸</span>. ì‘ë‹µì— 1-60ë¶„ ì†Œìš” ê°€ëŠ¥.<br>
            <b>ì¶”ì²œ ìƒí™©:</b> ëŒ€ëŸ‰ ì²˜ë¦¬, ë¬¸ì„œ ë¶„ì„, ì˜¤í”„ë¼ì¸ ìš”ì•½.<br>
            <b>OFF (ê¸°ë³¸):</b> ëª¨ë“  ìš”ì²­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì²˜ë¦¬.</span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Batch API <b>OFF</b> (not supported). All requests real-time. (SalmAlm exclusive)</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> Batch API <b>OFF</b> (ë¯¸ì§€ì›). ëª¨ë“  ìš”ì²­ ì‹¤ì‹œê°„ ì²˜ë¦¬. (ì‚¶ì• ì „ìš© ê¸°ëŠ¥)</span></span>
          </div>
        </div>

        <!-- File Pre-summarization -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <label style="font-size:14px;display:flex;align-items:center;gap:10px;cursor:pointer;margin-bottom:6px">
            <input type="checkbox" id="eng-file-presummary" style="width:18px;height:18px">
            <span class="eng-en"><b>ğŸ“„ File Pre-summarization</b></span><span class="eng-kr"><b>ğŸ“„ íŒŒì¼ ì‚¬ì „ ìš”ì•½</b></span>
          </label>
          <div style="font-size:12px;color:var(--text2);line-height:1.8;padding-left:28px">
            <span class="eng-en"><b>ON:</b> Large file contents (&gt;5KB) are first summarized by Haiku before being sent to the main model. Reduces input tokens by <span style="color:#4ade80">50-80%</span> for file-heavy tasks.<br>
            <b>Cost:</b> Extra Haiku call (~$0.001) but saves $0.01-0.05 on Sonnet/Opus input.<br>
            <b>Trade-off:</b> Summary may lose fine details. Disable for precise code review.<br>
            <b>OFF (default):</b> Full file contents sent to the main model as-is.</span>
            <span class="eng-kr"><b>ON:</b> ëŒ€ìš©ëŸ‰ íŒŒì¼(&gt;5KB)ì„ ë©”ì¸ ëª¨ë¸ì— ë³´ë‚´ê¸° ì „ì— Haikuë¡œ ë¨¼ì € ìš”ì•½í•©ë‹ˆë‹¤. íŒŒì¼ ì¤‘ì‹¬ ì‘ì—…ì—ì„œ ì…ë ¥ í† í° <span style="color:#4ade80">50-80% ì ˆê°</span>.<br>
            <b>ë¹„ìš©:</b> Haiku í˜¸ì¶œ ì¶”ê°€ (~$0.001) í•˜ì§€ë§Œ Sonnet/Opus ì…ë ¥ì—ì„œ $0.01-0.05 ì ˆì•½.<br>
            <b>íŠ¸ë ˆì´ë“œì˜¤í”„:</b> ìš”ì•½ ì‹œ ì„¸ë¶€ì‚¬í•­ ì†ì‹¤ ê°€ëŠ¥. ì •ë°€í•œ ì½”ë“œ ë¦¬ë·°ì—ëŠ” ë¹„í™œì„±í™” ê¶Œì¥.<br>
            <b>OFF (ê¸°ë³¸):</b> íŒŒì¼ ë‚´ìš© ì „ì²´ë¥¼ ë©”ì¸ ëª¨ë¸ì— ê·¸ëŒ€ë¡œ ì „ì†¡.</span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> File pre-summary <b>OFF</b>. Full file sent, AI manually chunks with offset/limit.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> íŒŒì¼ ì‚¬ì „ ìš”ì•½ <b>OFF</b>. íŒŒì¼ ì „ì²´ ì „ì†¡ í›„ AIê°€ offset/limitìœ¼ë¡œ ìˆ˜ë™ ë¶„í•  ì½ê¸°.</span></span>
          </div>
        </div>

        <!-- Streaming Early Stop -->
        <div style="border-left:3px solid var(--accent);padding-left:14px">
          <label style="font-size:14px;display:flex;align-items:center;gap:10px;cursor:pointer;margin-bottom:6px">
            <input type="checkbox" id="eng-early-stop" style="width:18px;height:18px">
            <span class="eng-en"><b>â¹ï¸ Streaming Early Stop</b></span><span class="eng-kr"><b>â¹ï¸ ìŠ¤íŠ¸ë¦¬ë° ì¡°ê¸° ì¤‘ë‹¨</b></span>
          </label>
          <div style="font-size:12px;color:var(--text2);line-height:1.8;padding-left:28px">
            <span class="eng-en"><b>ON:</b> Detects when the AI response is semantically complete (e.g., ends with punctuation, code block closed) and stops generation early. Saves <span style="color:#4ade80">10-30% output tokens</span> on verbose responses.<br>
            <b>Trade-off:</b> May occasionally cut off longer explanations.<br>
            <b>OFF (default):</b> Model generates until it naturally stops or hits max_tokens.</span>
            <span class="eng-kr"><b>ON:</b> AI ì‘ë‹µì´ ì˜ë¯¸ì ìœ¼ë¡œ ì™„ì„±ë˜ë©´(ë§ˆì¹¨í‘œ, ì½”ë“œ ë¸”ë¡ ë‹«í˜ ë“±) ìƒì„±ì„ ì¡°ê¸° ì¤‘ë‹¨í•©ë‹ˆë‹¤. ì¥í™©í•œ ì‘ë‹µì—ì„œ <span style="color:#4ade80">ì¶œë ¥ í† í° 10-30% ì ˆê°</span>.<br>
            <b>íŠ¸ë ˆì´ë“œì˜¤í”„:</b> ê¸´ ì„¤ëª…ì´ ê°„í˜¹ ì˜ë¦´ ìˆ˜ ìˆìŒ.<br>
            <b>OFF (ê¸°ë³¸):</b> ëª¨ë¸ì´ ìì—°ìŠ¤ëŸ½ê²Œ ì¤‘ë‹¨í•˜ê±°ë‚˜ max_tokensì— ë„ë‹¬í•  ë•Œê¹Œì§€ ìƒì„±.</span><br>
            <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Early Stop <b>OFF</b>. Uses <code>reasoning_effort</code> to control verbosity from the start.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> Early Stop <b>OFF</b>. ëŒ€ì‹  <code>reasoning_effort</code>ë¡œ ì²˜ìŒë¶€í„° ê°„ê²°í•˜ê²Œ ë‹µí•˜ë„ë¡ ì¡°ì ˆ.</span></span>
          </div>
        </div>

      </div>

      <!-- Summary bar -->
      <div style="background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:14px;margin-top:20px;font-size:12px;line-height:1.8">
        <span class="eng-en"><b>ğŸ’¡ Recommended Presets:</b><br>
        ğŸŸ¢ <b>Maximum Savings:</b> Dynamic Tools âœ… Â· Planning âŒ Â· Reflection âŒ Â· Compaction 15K Â· Cache 24h Â· Early Stop âœ… Â· File Summary âœ… Â· Cap $2/day<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">Chat ~$0.0005/turn, Coding ~$0.008/turn</span><br>
        ğŸŸ¡ <b>Balanced:</b> Dynamic Tools âœ… Â· Planning âŒ Â· Reflection âŒ Â· Compaction 30K Â· Cache 4h Â· Cap $10/day<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">Chat ~$0.002/turn, Coding ~$0.02/turn</span><br>
        ğŸ”´ <b>Maximum Quality:</b> Dynamic Tools âŒ Â· Planning âœ… Â· Reflection âœ… Â· Compaction 120K Â· Cache off Â· No cap<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">Chat ~$0.05/turn, Coding ~$0.15/turn</span><br>
        ğŸ”µ <b>OpenClaw-like:</b> Dynamic Tools âŒ Â· Planning âŒ Â· Reflection âŒ Â· Compaction 120K Â· Tool Iterations â™¾ï¸ Â· Cache off Â· No cap<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">All tools always loaded, no limits â€” same behavior as OpenClaw. Most expensive but maximum freedom.</span></span>
        <span class="eng-kr"><b>ğŸ’¡ ê¶Œì¥ í”„ë¦¬ì…‹:</b><br>
        ğŸŸ¢ <b>ìµœëŒ€ ì ˆì•½:</b> Dynamic Tools âœ… Â· Planning âŒ Â· Reflection âŒ Â· Compaction 15K Â· Cache 24h Â· Early Stop âœ… Â· File Summary âœ… Â· Cap $2/day<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">ì¡ë‹´ ~$0.0005/í„´, ì½”ë”© ~$0.008/í„´</span><br>
        ğŸŸ¡ <b>ê· í˜•:</b> Dynamic Tools âœ… Â· Planning âŒ Â· Reflection âŒ Â· Compaction 30K Â· Cache 4h Â· Cap $10/day<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">ì¡ë‹´ ~$0.002/í„´, ì½”ë”© ~$0.02/í„´</span><br>
        ğŸ”´ <b>ìµœëŒ€ í’ˆì§ˆ:</b> Dynamic Tools âŒ Â· Planning âœ… Â· Reflection âœ… Â· Compaction 120K Â· Cache off Â· No cap<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">ì¡ë‹´ ~$0.05/í„´, ì½”ë”© ~$0.15/í„´</span><br>
        ğŸ”µ <b>ì˜¤í”ˆí´ë¡œì²˜ëŸ¼:</b> Dynamic Tools âŒ Â· Planning âŒ Â· Reflection âŒ Â· Compaction 120K Â· Tool Iterations â™¾ï¸ Â· Cache off Â· No cap<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:var(--text2)">ëª¨ë“  ë„êµ¬ í•­ìƒ ë¡œë“œ, ì œí•œ ì—†ìŒ â€” ì˜¤í”ˆí´ë¡œì™€ ë™ì¼í•œ ë™ì‘. ê°€ì¥ ë¹„ì‹¸ì§€ë§Œ ìµœëŒ€ ììœ ë„.</span></span>
      </div>

      <button class="btn" data-action="saveEngineSettings" style="margin-top:16px;font-size:14px;padding:10px 24px"><span class="eng-en">ğŸ’¾ Save</span><span class="eng-kr">ğŸ’¾ ì €ì¥</span></button>
      <span id="eng-save-result" style="font-size:12px;margin-left:8px"></span>
    </div>
    <div style="margin-bottom:16px"><input id="features-search" type="text" placeholder="Search features..." data-i18n="features-search-ph" style="width:100%;padding:10px 14px;border-radius:10px;border:1px solid var(--border);background:var(--bg2);color:var(--text);font-size:14px"></div>
    <div id="features-list"></div>
    <div id="features-empty" style="display:none;text-align:center;padding:40px;color:var(--text2);font-size:14px" data-i18n="features-empty">No features found.</div>
  </div>
  <div id="settings-model-router" style="display:none">
    <!-- Active Model -->
    <div class="settings-card">
      <div id="mr-current" style="padding:16px;border-radius:10px;background:var(--accent-dim);display:flex;align-items:center;gap:12px;margin-bottom:0">
        <span style="font-size:28px">ğŸ¯</span>
        <div style="flex:1">
          <div style="font-size:11px;color:var(--text2);text-transform:uppercase;letter-spacing:0.5px" data-i18n="mr-active">Active Model</div>
          <div id="mr-current-name" style="font-size:18px;font-weight:700;color:var(--accent2)">Auto</div>
        </div>
        <select id="s-model" data-action="setModel" style="padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:12px;max-width:220px">
          <option value="auto">ğŸ”„ Auto Routing</option>
        </select>
      </div>
      <div id="mr-routing-hint" style="padding:10px 16px;font-size:12px;color:var(--text2);line-height:1.6;display:none;background:var(--bg);border-radius:0 0 10px 10px;border-top:1px solid var(--border)">
        <span class="eng-en">âš ï¸ <b>Fixed model selected</b> â€” Auto Routing is disabled. All messages use this model regardless of complexity.<br>
        Select <b>ğŸ”„ Auto Routing</b> above to enable cost-optimized routing (Haiku for chat, Sonnet for code).</span>
        <span class="eng-kr">âš ï¸ <b>ê³ ì • ëª¨ë¸ ì„ íƒë¨</b> â€” ìë™ ë¼ìš°íŒ…ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤. ë³µì¡ë„ì— ê´€ê³„ì—†ì´ ëª¨ë“  ë©”ì‹œì§€ê°€ ì´ ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.<br>
        ë¹„ìš© ìµœì í™” ë¼ìš°íŒ…ì„ ì‚¬ìš©í•˜ë ¤ë©´ ìœ„ì—ì„œ <b>ğŸ”„ Auto Routing</b>ì„ ì„ íƒí•˜ì„¸ìš”.</span>
      </div>
    </div>
    <!-- Provider Cards -->
    <div class="settings-card">
      <h3 data-i18n="mr-providers-title">ğŸ“¦ Models by Provider</h3>
      <p style="font-size:12px;color:var(--text2);margin-bottom:12px" data-i18n="mr-providers-desc">Click a model to switch. Pricing per 1M tokens (input / output).</p>
      <div id="mr-provider-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:12px"></div>
    </div>
    <!-- Auto Routing -->
    <div class="settings-card">
      <h3 data-i18n="h-routing">ğŸ”€ Auto Routing / ìë™ ë¼ìš°íŒ…</h3>
      <p style="font-size:12px;color:var(--text2);margin:4px 0 12px;line-height:1.8">
        <span class="eng-en">SalmAlm automatically classifies each message by complexity and routes it to the optimal model.<br>
        This saves money by using cheap models for simple tasks and powerful models only when needed.</span>
        <span class="eng-kr">ì‚¶ì•ì€ ê° ë©”ì‹œì§€ì˜ ë³µì¡ë„ë¥¼ ìë™ ë¶„ë¥˜í•˜ì—¬ ìµœì ì˜ ëª¨ë¸ë¡œ ë¼ìš°íŒ…í•©ë‹ˆë‹¤.<br>
        ê°„ë‹¨í•œ ì‘ì—…ì— ì €ë ´í•œ ëª¨ë¸ì„, ë³µì¡í•œ ì‘ì—…ì—ë§Œ ê°•ë ¥í•œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ìš©ì„ ì ˆê°í•©ë‹ˆë‹¤.</span><br>
        <span style="background:var(--bg);padding:4px 8px;border-radius:6px;border:1px solid var(--border)"><span class="eng-en">ğŸ†š <b>OpenClaw:</b> Auto Routing <b>OFF</b>. One model per session. Manual switch via <code>/model opus</code> only.</span><span class="eng-kr">ğŸ†š <b>ì˜¤í”ˆí´ë¡œ:</b> Auto Routing <b>OFF</b>. ì„¸ì…˜ë‹¹ í•˜ë‚˜ì˜ ëª¨ë¸ ê³ ì •. <code>/model opus</code>ë¡œ ìˆ˜ë™ ì „í™˜ë§Œ ê°€ëŠ¥.</span></span>
      </p>

      <!-- How classification works -->
      <details style="margin-bottom:16px">
        <summary style="font-size:13px;color:var(--accent2);cursor:pointer;font-weight:600"><span class="eng-en">ğŸ“– How does classification work?</span><span class="eng-kr">ğŸ“– ë¶„ë¥˜ëŠ” ì–´ë–»ê²Œ ì‘ë™í•˜ë‚˜ìš”?</span></summary>
        <div style="font-size:12px;color:var(--text2);margin-top:10px;padding:12px;background:var(--bg);border-radius:8px;border:1px solid var(--border);line-height:2">
          <span class="eng-en"><b>âš¡ Simple</b> â€” Short messages &lt;50 chars, greetings, yes/no, emoji<br>
          &nbsp;&nbsp;&nbsp;Examples: "ì•ˆë…•", "ã…‹ã…‹", "ok", "ê³ ë§ˆì›Œ", "ë­í•´", "ì˜ì"<br>
          <b>ğŸ”§ Moderate</b> â€” Code keywords, analysis, summaries, 50-500 chars<br>
          &nbsp;&nbsp;&nbsp;Examples: "ì´ ì½”ë“œ ë¦¬ë·°í•´ì¤˜", "ìš”ì•½í•´ì¤˜", "ë²ˆì—­í•´ì¤˜"<br>
          <b>ğŸ’ Complex</b> â€” Architecture, system design, long messages &gt;500 chars, thinking mode<br>
          &nbsp;&nbsp;&nbsp;Examples: "ì²˜ìŒë¶€í„° API ì„œë²„ ì„¤ê³„í•´ì¤˜", "ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš"</span>
          <span class="eng-kr"><b>âš¡ Simple</b> â€” 50ì ë¯¸ë§Œ ì§§ì€ ë©”ì‹œì§€, ì¸ì‚¬, ì˜ˆ/ì•„ë‹ˆì˜¤, ì´ëª¨ì§€<br>
          &nbsp;&nbsp;&nbsp;ì˜ˆì‹œ: "ì•ˆë…•", "ã…‹ã…‹", "ok", "ê³ ë§ˆì›Œ", "ë­í•´", "ì˜ì"<br>
          <b>ğŸ”§ Moderate</b> â€” ì½”ë“œ, ë¶„ì„, ìš”ì•½, ë²ˆì—­ í‚¤ì›Œë“œ í¬í•¨, 50~500ì<br>
          &nbsp;&nbsp;&nbsp;ì˜ˆì‹œ: "ì´ ì½”ë“œ ë¦¬ë·°í•´ì¤˜", "ìš”ì•½í•´ì¤˜", "ë²ˆì—­í•´ì¤˜"<br>
          <b>ğŸ’ Complex</b> â€” ì•„í‚¤í…ì²˜, ì„¤ê³„, 500ì ì´ìƒ ê¸´ ë©”ì‹œì§€, thinking ëª¨ë“œ í™œì„±í™” ì‹œ<br>
          &nbsp;&nbsp;&nbsp;ì˜ˆì‹œ: "ì²˜ìŒë¶€í„° API ì„œë²„ ì„¤ê³„í•´ì¤˜", "ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš"</span>
        </div>
      </details>

      <!-- Tier selectors with cost info -->
      <div style="display:flex;flex-direction:column;gap:16px">
        <div style="border-left:3px solid #4ade80;padding-left:14px">
          <label style="font-size:13px;font-weight:600">âš¡ Simple <span style="font-size:11px;font-weight:400;color:var(--text2)"><span class="eng-en">(~60% of messages)</span><span class="eng-kr">(ë©”ì‹œì§€ì˜ ~60%)</span></span></label>
          <div style="font-size:11px;color:var(--text2);margin:4px 0 6px;line-height:1.6">
            <span class="eng-en">Greetings, short questions, casual chat. No tools needed.</span>
            <span class="eng-kr">ì¸ì‚¬, ì§§ì€ ì§ˆë¬¸, ì¡ë‹´. ë„êµ¬ ë¶ˆí•„ìš”.</span>
            <span style="color:#4ade80">Default: Haiku â€” $0.25/$1.25 per M tokens (cheapest)</span>
          </div>
          <select id="route-simple" class="route-select" style="width:100%;padding:8px 10px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px"><option value="">ğŸ”„ Auto â€” Haiku</option></select>
        </div>

        <div style="border-left:3px solid #facc15;padding-left:14px">
          <label style="font-size:13px;font-weight:600">ğŸ”§ Moderate <span style="font-size:11px;font-weight:400;color:var(--text2)"><span class="eng-en">(~25% of messages)</span><span class="eng-kr">(ë©”ì‹œì§€ì˜ ~25%)</span></span></label>
          <div style="font-size:11px;color:var(--text2);margin:4px 0 6px;line-height:1.6">
            <span class="eng-en">Code review, analysis, summaries, search, translations.</span>
            <span class="eng-kr">ì½”ë“œ ë¦¬ë·°, ë¶„ì„, ìš”ì•½, ê²€ìƒ‰, ë²ˆì—­.</span>
            <span style="color:#facc15">Default: Sonnet â€” $3/$15 per M tokens (balanced)</span>
          </div>
          <select id="route-moderate" class="route-select" style="width:100%;padding:8px 10px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px"><option value="">ğŸ”„ Auto â€” Sonnet</option></select>
        </div>

        <div style="border-left:3px solid #f97316;padding-left:14px">
          <label style="font-size:13px;font-weight:600">ğŸ’ Complex <span style="font-size:11px;font-weight:400;color:var(--text2)"><span class="eng-en">(~15% of messages)</span><span class="eng-kr">(ë©”ì‹œì§€ì˜ ~15%)</span></span></label>
          <div style="font-size:11px;color:var(--text2);margin:4px 0 6px;line-height:1.6">
            <span class="eng-en">System design, architecture, long reasoning, thinking mode tasks.</span>
            <span class="eng-kr">ì‹œìŠ¤í…œ ì„¤ê³„, ì•„í‚¤í…ì²˜, ê¸´ ì¶”ë¡ , thinking ëª¨ë“œ ì‘ì—….</span>
            <span style="color:#f97316"><span class="eng-en">Default: Sonnet â€” $3/$15 per M tokens. Set Opus for maximum quality ($15/$75).</span><span class="eng-kr">ê¸°ë³¸: Sonnet â€” $3/$15 per M tokens. ìµœëŒ€ í’ˆì§ˆì€ Opus ì„¤ì • ($15/$75).</span></span>
          </div>
          <select id="route-complex" class="route-select" style="width:100%;padding:8px 10px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px"><option value="">ğŸ”„ Auto â€” Sonnet</option></select>
        </div>
      </div>

      <!-- Cost comparison -->
      <div style="background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:14px;margin-top:16px;font-size:12px;line-height:2">
        <span class="eng-en"><b>ğŸ’° Estimated Daily Cost (100 calls/day):</b></span><span class="eng-kr"><b>ğŸ’° ì˜ˆìƒ ì¼ì¼ ë¹„ìš© (100íšŒ/ì¼):</b></span><br>
        ğŸŸ¢ <b>Default (Haiku+Sonnet+Sonnet):</b> ~$1.23/day ($37/month)<br>
        ğŸŸ¡ <b>All Sonnet:</b> ~$3.50/day ($105/month)<br>
        ğŸ”´ <b>All Opus:</b> ~$35/day ($1,050/month)<br>
        ğŸŸ£ <b>Haiku+Sonnet+Opus:</b> ~$5.80/day ($174/month) â€” <span style="color:var(--accent)"><span class="eng-en">Best quality/cost balance</span><span class="eng-kr">ìµœì  í’ˆì§ˆ/ë¹„ìš© ê· í˜•</span></span><br>
        <br>
        <span style="color:var(--text2)"><span class="eng-en">ğŸ’¡ Tip: Use <code>/model opus</code> in chat to temporarily override for a single session without changing these defaults.</span><span class="eng-kr">ğŸ’¡ íŒ: ì±„íŒ…ì—ì„œ <code>/model opus</code>ë¡œ ì´ ê¸°ë³¸ê°’ì„ ë°”ê¾¸ì§€ ì•Šê³  í˜„ì¬ ì„¸ì…˜ë§Œ ì¼ì‹œì ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span></span>
      </div>

      <div style="margin-top:14px;display:flex;align-items:center;gap:8px">
        <button data-action="saveRouting" style="padding:8px 16px;border-radius:8px;border:none;background:var(--accent);color:#fff;cursor:pointer;font-size:13px;font-weight:600" data-i18n="btn-save-routing">ğŸ’¾ Save Routing / ì €ì¥</button>
        <span id="route-status" style="font-size:12px;color:var(--text2)"></span>
      </div>
    </div>
    <!-- Ollama -->
    <div class="settings-card">
      <h3>ğŸ¦™ Ollama (Local LLM)</h3>
      <label data-i18n="lbl-ollama">Ollama URL</label>
      <input id="s-ollama-url" type="text" placeholder="http://localhost:11434/v1" style="width:100%;padding:8px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px">
      <button data-action="saveOllama" style="margin-top:4px;padding:6px 12px;border-radius:6px;border:none;background:var(--accent);color:#fff;cursor:pointer;font-size:12px" data-i18n="btn-save-ollama">Save Ollama URL</button>
    </div>
    <!-- API Keys -->
    <div class="settings-card">
      <h3 data-i18n="h-keys">ğŸ”‘ API Keys</h3>
      <p style="font-size:12px;color:var(--text2);margin-bottom:12px" data-i18n="mr-keys-desc">Enter API keys to enable providers. Keys are tested in real-time.</p>
      <label data-i18n="lbl-anthropic">Anthropic API Key</label>
      <div style="display:flex;gap:6px"><input id="sk-anthropic" type="password" placeholder="sk-ant-..."><button class="btn" data-action="save-anthropic">Save</button><button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="test-anthropic">Test</button></div>
      <label data-i18n="lbl-openai">OpenAI API Key</label>
      <div style="display:flex;gap:6px"><input id="sk-openai" type="password" placeholder="sk-..."><button class="btn" data-action="save-openai">Save</button><button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="test-openai">Test</button></div>
      <label data-i18n="lbl-xai">xAI API Key (Grok)</label>
      <div style="display:flex;gap:6px"><input id="sk-xai" type="password" placeholder="xai-..."><button class="btn" data-action="save-xai">Save</button><button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="test-xai">Test</button></div>
      <label data-i18n="lbl-google">Google API Key (Gemini)</label>
      <div style="display:flex;gap:6px"><input id="sk-google" type="password" placeholder="AIza..."><button class="btn" data-action="save-google">Save</button><button class="btn" style="background:var(--bg3);color:var(--text2)" data-action="test-google">Test</button></div>
      <label data-i18n="lbl-brave">Brave Search API Key</label>
      <div style="display:flex;gap:6px"><input id="sk-brave" type="password" placeholder="BSA..."><button class="btn" data-action="save-brave">Save</button></div>
      <div id="key-test-result" style="margin-top:8px;font-size:12px"></div>
      <div id="vault-keys" style="margin-top:12px"></div>
    </div>
  </div>
  <!-- Logs Tab -->
  <div id="settings-debug" style="display:none">
    <div class="settings-card">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px">
        <h3 style="margin:0" data-i18n="h-debug">ğŸ”¬ Debug Diagnostics</h3>
        <button class="btn" data-action="refreshDebug" style="font-size:12px">ğŸ”„ Refresh</button>
        <label style="font-size:12px;display:flex;align-items:center;gap:4px;margin-left:auto"><input type="checkbox" id="debug-auto-refresh"> Auto (3s)</label>
      </div>
      <div id="debug-panel" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      </div>
    </div>
  </div>
  <div id="settings-logs" style="display:none">
    <div class="settings-card">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
        <h3 style="margin:0" data-i18n="h-logs">ğŸ“‹ Server Logs</h3>
        <select id="log-level" style="padding:4px 8px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:12px">
          <option value="">All</option>
          <option value="ERROR">âŒ Error</option>
          <option value="WARNING">âš ï¸ Warning</option>
          <option value="INFO">â„¹ï¸ Info</option>
        </select>
        <select id="log-lines" style="padding:4px 8px;border-radius:6px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:12px">
          <option value="50">50 lines</option>
          <option value="100" selected>100 lines</option>
          <option value="300">300 lines</option>
          <option value="500">500 lines</option>
        </select>
        <button class="btn" data-action="refreshLogs" style="font-size:12px">ğŸ”„ Refresh</button>
        <label style="font-size:12px;display:flex;align-items:center;gap:4px;margin-left:auto"><input type="checkbox" id="log-auto-refresh"> Auto (5s)</label>
      </div>
      <div id="log-viewer" style="background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:12px;font-family:'SF Mono',Consolas,monospace;font-size:12px;line-height:1.6;max-height:600px;overflow-y:auto;white-space:pre-wrap;word-break:break-all;color:var(--text)"></div>
    </div>
  </div>
</div>

<div id="input-area">
  <div class="input-box">
    <textarea id="input" rows="1" placeholder="Type a message..." data-i18n="input-ph"></textarea>
    <button id="thinking-btn" data-action="toggleThinking" title="Extended Thinking" style="width:36px;height:36px;border-radius:10px;border:none;background:var(--bg3);color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;transition:all 0.15s">ğŸ§ </button>
    <button id="attach-btn" title="Attach file" data-action="attachFile" style="width:36px;height:36px;border-radius:10px;border:none;background:var(--bg3);color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;transition:all 0.15s">ğŸ“</button>
    <input type="file" id="file-input-hidden" accept="image/png,image/jpeg,image/gif,image/webp,.txt,.md,.py,.js,.json,.csv,.html,.css,.pdf" style="display:none">
    <button id="mic-btn" data-action="toggleMic" title="Voice input" style="width:36px;height:36px;border-radius:10px;border:none;background:var(--bg3);color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;transition:all 0.15s">ğŸ¤</button>
    <button id="queue-btn" data-action="queueMsg" title="Add to queue" style="width:36px;height:36px;border-radius:10px;border:none;background:var(--bg3);color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;transition:all 0.15s">ğŸ“¥</button>
    <button id="stop-btn" data-action="stopGen" title="Stop generating" style="display:none;width:36px;height:36px;border-radius:10px;border:none;background:var(--red,#f87171);color:#fff;cursor:pointer;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;transition:all 0.15s">â¹</button>
    <button id="send-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 2L11 13"/><path d="M22 2L15 22L11 13L2 9L22 2Z"/></svg>
    </button>
  </div>
  <div id="file-preview" style="display:none;padding:8px 0">
    <div style="display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--bg3);border-radius:8px;font-size:12px;color:var(--text2)">
      <span id="file-icon">ğŸ“</span>
      <span id="file-name" style="flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"></span>
      <span id="file-size"></span>
      <button data-action="clearFile" style="background:none;border:none;color:var(--red);cursor:pointer;font-size:14px">âœ•</button>
    </div>
    <img id="img-preview" style="display:none;max-height:120px;border-radius:8px;margin-top:8px">
  </div>
  <div class="input-hint" data-i18n="input-hint">Enter to send Â· Shift+Enter newline Â· Ctrl+V paste Â· Drag&Drop files</div>
</div>

<div id="dashboard-view" style="display:none;grid-area:chat;overflow-y:auto;padding:20px;max-width:1200px;margin:0 auto">
  <div style="margin-bottom:16px"><a href="#" data-action="showChat" style="color:var(--accent);text-decoration:none;font-size:13px" data-i18n="dash-back">â† Back to Chat</a></div>
  <h2 style="margin-bottom:4px" data-i18n="dash-title">ğŸ“ˆ Dashboard</h2>
  <p style="font-size:13px;color:var(--text2);margin-bottom:16px" data-i18n="dash-desc">See where tokens go, when sessions spike, and what drives cost.</p>
  <!-- Filters -->
  <div style="background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:16px;margin-bottom:16px">
    <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
      <span style="font-weight:600;font-size:13px" data-i18n="dash-filters">Filters</span>
      <button class="btn" data-action="dashRange" data-range="today" style="font-size:11px;padding:4px 10px">Today</button>
      <button class="btn" data-action="dashRange" data-range="7d" style="font-size:11px;padding:4px 10px">7d</button>
      <button class="btn" data-action="dashRange" data-range="30d" style="font-size:11px;padding:4px 10px">30d</button>
      <input type="date" id="dash-from" style="padding:4px 8px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);font-size:12px">
      <span style="font-size:12px;color:var(--text2)">to</span>
      <input type="date" id="dash-to" style="padding:4px 8px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);font-size:12px">
      <div style="display:flex;gap:2px;margin-left:8px">
        <button class="btn" id="dash-mode-tokens" data-action="dashMode" data-mode="tokens" style="font-size:11px;padding:4px 12px;background:var(--accent);color:#fff">Tokens</button>
        <button class="btn" id="dash-mode-cost" data-action="dashMode" data-mode="cost" style="font-size:11px;padding:4px 12px">Cost</button>
      </div>
      <button class="btn" data-action="refreshDashboard" style="font-size:11px;padding:4px 14px;background:#ef4444;color:#fff">Refresh</button>
    </div>
  </div>
  <div id="dashboard-content" style="color:var(--text2)">Loading...</div>
</div>

<!-- Cron Jobs Panel -->
<div id="cron-view" style="display:none;grid-area:chat;overflow-y:auto;padding:20px;max-width:1200px;margin:0 auto">
  <div style="margin-bottom:16px"><a href="#" data-action="showChat" style="color:var(--accent);text-decoration:none;font-size:13px">â† Back to Chat</a></div>
  <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px">
    <h2 style="margin:0" data-i18n="cron-title">â° Cron Jobs</h2>
    <button class="btn" data-action="refreshCron" style="font-size:12px">ğŸ”„</button>
    <button class="btn" data-action="addCronForm" style="font-size:12px;background:var(--accent);color:#fff" data-i18n="cron-add">â• Add Job</button>
  </div>
  <div id="cron-add-form" style="display:none;background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:16px">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
      <div><label style="font-size:12px;font-weight:600" data-i18n="cron-name">Name</label><input id="cron-name" type="text" placeholder="my-job" style="width:100%;padding:8px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);font-size:13px;margin-top:4px"></div>
      <div><label style="font-size:12px;font-weight:600" data-i18n="cron-schedule">Schedule</label>
        <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px">
          <button type="button" class="btn cron-preset" data-seconds="300" style="font-size:11px;padding:4px 10px">5m</button>
          <button type="button" class="btn cron-preset" data-seconds="900" style="font-size:11px;padding:4px 10px">15m</button>
          <button type="button" class="btn cron-preset" data-seconds="1800" style="font-size:11px;padding:4px 10px">30m</button>
          <button type="button" class="btn cron-preset" data-seconds="3600" style="font-size:11px;padding:4px 10px;background:var(--accent);color:#fff">1h</button>
          <button type="button" class="btn cron-preset" data-seconds="7200" style="font-size:11px;padding:4px 10px">2h</button>
          <button type="button" class="btn cron-preset" data-seconds="21600" style="font-size:11px;padding:4px 10px">6h</button>
          <button type="button" class="btn cron-preset" data-seconds="43200" style="font-size:11px;padding:4px 10px">12h</button>
          <button type="button" class="btn cron-preset" data-seconds="86400" style="font-size:11px;padding:4px 10px">24h</button>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px">
          <div>
            <label style="font-size:11px;color:var(--text2)" data-i18n="cron-interval">Interval (seconds)</label>
            <input id="cron-interval" type="number" value="3600" min="60" style="width:100%;padding:8px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);font-size:13px;margin-top:2px">
          </div>
          <div>
            <label style="font-size:11px;color:var(--text2)" data-i18n="cron-at">Run at (optional)</label>
            <input id="cron-at" type="time" style="width:100%;padding:8px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);font-size:13px;margin-top:2px">
          </div>
        </div>
      </div>
    </div>
    <label style="font-size:12px;font-weight:600" data-i18n="cron-prompt">Prompt</label>
    <textarea id="cron-prompt" rows="3" placeholder="What should the AI do?" style="width:100%;padding:8px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);font-size:13px;margin-top:4px;resize:vertical"></textarea>
    <div style="display:flex;gap:8px;margin-top:12px">
      <button class="btn" data-action="saveCron" style="background:var(--accent);color:#fff" data-i18n="btn-save">Save</button>
      <button class="btn" data-action="cancelCron" style="background:var(--bg3)" data-i18n="btn-cancel">Cancel</button>
    </div>
  </div>
  <div id="cron-table">Loading...</div>
</div>

<!-- Memory Panel -->
<div id="memory-view" style="display:none;grid-area:chat;overflow-y:auto;padding:20px;max-width:1200px;margin:0 auto">
  <div style="margin-bottom:16px"><a href="#" data-action="showChat" style="color:var(--accent);text-decoration:none;font-size:13px">â† Back to Chat</a></div>
  <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px">
    <h2 style="margin:0" data-i18n="mem-title">ğŸ§  Memory</h2>
    <button class="btn" data-action="refreshMemory" style="font-size:12px">ğŸ”„</button>
  </div>
  <div style="display:grid;grid-template-columns:250px 1fr;gap:16px">
    <div id="mem-file-list" style="border:1px solid var(--border);border-radius:10px;overflow:hidden;max-height:500px;overflow-y:auto"></div>
    <div id="mem-file-content" style="border:1px solid var(--border);border-radius:10px;padding:16px;max-height:500px;overflow-y:auto">
      <div style="color:var(--text2);font-size:13px" data-i18n="mem-select">Select a memory file to view</div>
    </div>
  </div>
</div>

<!-- Sessions Panel -->
<div id="sessions-view" style="display:none;grid-area:chat;overflow-y:auto;padding:20px;max-width:1200px;margin:0 auto">
  <div style="margin-bottom:16px"><a href="#" data-action="showChat" style="color:var(--accent);text-decoration:none;font-size:13px">â† Back to Chat</a></div>
  <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px">
    <h2 style="margin:0" data-i18n="sess-title">ğŸ“‹ Sessions</h2>
    <input id="sess-search" type="text" placeholder="Search sessions..." style="flex:1;padding:8px 12px;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:13px" data-i18n-ph="sess-search-ph">
    <button class="btn" data-action="refreshSessions" style="font-size:12px">ğŸ”„</button>
  </div>
  <div id="sessions-table" style="color:var(--text2)">Loading...</div>
</div>

<!-- Docs Panel -->
<div id="docs-view" style="display:none;grid-area:chat;overflow-y:auto;padding:20px;max-width:900px;margin:0 auto">
  <div style="margin-bottom:16px"><a href="#" data-action="showChat" style="color:var(--accent);text-decoration:none;font-size:13px">â† Back to Chat</a></div>
  <h2 style="margin-bottom:16px" data-i18n="docs-title">ğŸ“– Documentation</h2>
  <input id="docs-search" type="text" placeholder="Search docs..." style="width:100%;padding:10px 14px;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:14px;margin-bottom:16px" data-i18n-ph="docs-search-ph">
  <div id="docs-content"></div>
</div>

<div id="search-modal">
  <div id="search-box">
    <input id="search-input" type="text" placeholder="ğŸ” Search conversations... (Ctrl+K)" data-i18n-ph="search-ph">
    <div id="search-results"></div>
    <div id="search-hint" data-i18n="search-hint">Esc to close Â· Enter to select Â· Type to search</div>
  </div>
</div>

<script src="/static/app.js"></script></body></html>
